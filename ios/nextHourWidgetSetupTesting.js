(()=>{var $=Object.create;var V=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var ee=Object.getOwnPropertyNames;var te=Object.getPrototypeOf,re=Object.prototype.hasOwnProperty;var ie=(o,r)=>()=>(r||o((r={exports:{}}).exports,r),r.exports);var ne=(o,r,e,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let t of ee(r))!re.call(o,t)&&t!==e&&V(o,t,{get:()=>r[t],enumerable:!(i=Q(r,t))||i.enumerable});return o};var se=(o,r,e)=>(e=o!=null?$(te(o)):{},ne(r||!o||!o.__esModule?V(e,"default",{value:o,enumerable:!0}):e,o));var K=ie((le,F)=>{var n;(function(){typeof F=="object"?n=F.exports:typeof HTMLScriptElement<"u"&&"noModule"in HTMLScriptElement.prototype?window.ICAL=n={}:typeof n!="object"&&(n={})})();n.foldLength=75;n.newLineChar=`\r
`;n.helpers={updateTimezones:function(o){var r,e,i,t,s,a;if(!o||o.name!=="vcalendar")return o;for(r=o.getAllSubcomponents(),e=[],i={},s=0;s<r.length;s++)r[s].name==="vtimezone"?(a=r[s].getFirstProperty("tzid").getFirstValue(),i[a]=r[s]):e=e.concat(r[s].getAllProperties());for(t={},s=0;s<e.length;s++)(a=e[s].getParameter("tzid"))&&(t[a]=!0);for(s in i)i.hasOwnProperty(s)&&!t[s]&&o.removeSubcomponent(i[s]);for(s in t)t.hasOwnProperty(s)&&!i[s]&&n.TimezoneService.has(s)&&o.addSubcomponent(n.TimezoneService.get(s).component);return o},isStrictlyNaN:function(o){return typeof o=="number"&&isNaN(o)},strictParseInt:function(o){var r=parseInt(o,10);if(n.helpers.isStrictlyNaN(r))throw new Error('Could not extract integer from "'+o+'"');return r},formatClassType:function(r,e){if(!(typeof r>"u"))return r instanceof e?r:new e(r)},unescapedIndexOf:function(o,r,e){for(;(e=o.indexOf(r,e))!==-1;)if(e>0&&o[e-1]==="\\")e+=1;else return e;return-1},binsearchInsert:function(o,r,e){if(!o.length)return 0;for(var i=0,t=o.length-1,s,a;i<=t;)if(s=i+Math.floor((t-i)/2),a=e(r,o[s]),a<0)t=s-1;else if(a>0)i=s+1;else break;return a<0?s:a>0?s+1:s},dumpn:function(){!n.debug||(typeof console<"u"&&"log"in console?n.helpers.dumpn=function(r){console.log(r)}:n.helpers.dumpn=function(r){dump(r+`
`)},n.helpers.dumpn(arguments[0]))},clone:function(o,r){if(!o||typeof o!="object")return o;if(o instanceof Date)return new Date(o.getTime());if("clone"in o)return o.clone();if(Array.isArray(o)){for(var e=[],i=0;i<o.length;i++)e.push(r?n.helpers.clone(o[i],!0):o[i]);return e}else{var t={};for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r?t[s]=n.helpers.clone(o[s],!0):t[s]=o[s]);return t}},foldline:function(r){for(var e="",i=r||"",t=0,s=0;i.length;){var a=i.codePointAt(t);a<128?++s:a<2048?s+=2:a<65536?s+=3:s+=4,s<n.foldLength+1?t+=a>65535?2:1:(e+=n.newLineChar+" "+i.substring(0,t),i=i.substring(t),t=s=0)}return e.substr(n.newLineChar.length+1)},pad2:function(r){typeof r!="string"&&(typeof r=="number"&&(r=parseInt(r)),r=String(r));var e=r.length;switch(e){case 0:return"00";case 1:return"0"+r;default:return r}},trunc:function(r){return r<0?Math.ceil(r):Math.floor(r)},inherits:function(o,r,e){function i(){}i.prototype=o.prototype,r.prototype=new i,e&&n.helpers.extend(e,r.prototype)},extend:function(o,r){for(var e in o){var i=Object.getOwnPropertyDescriptor(o,e);i&&!Object.getOwnPropertyDescriptor(r,e)&&Object.defineProperty(r,e,i)}return r}};n.design=function(){"use strict";var o=/\\\\|\\;|\\,|\\[Nn]/g,r=/\\|;|,|\n/g,e=/\\\\|\\,|\\[Nn]/g,i=/\\|,|\n/g;function t(h,T){var w={matches:/.*/,fromICAL:function(Y,R){return _(Y,h,R)},toICAL:function(Y,R){var L=T;return R&&(L=new RegExp(L.source+"|"+R)),Y.replace(L,function(k){switch(k){case"\\":return"\\\\";case";":return"\\;";case",":return"\\,";case`
`:return"\\n";default:return k}})}};return w}var s={defaultType:"text"},a={defaultType:"text",multiValue:","},u={defaultType:"text",structuredValue:";"},c={defaultType:"integer"},v={defaultType:"date-time",allowedTypes:["date-time","date"]},f={defaultType:"date-time"},d={defaultType:"uri"},l={defaultType:"utc-offset"},m={defaultType:"recur"},y={defaultType:"date-and-or-time",allowedTypes:["date-time","date","text"]};function p(h){switch(h){case"\\\\":return"\\";case"\\;":return";";case"\\,":return",";case"\\n":case"\\N":return`
`;default:return h}}function _(h,T,w){return h.indexOf("\\")===-1?h:(w&&(T=new RegExp(T.source+"|\\\\"+w)),h.replace(T,p))}var A={categories:a,url:d,version:s,uid:s},D={boolean:{values:["TRUE","FALSE"],fromICAL:function(h){switch(h){case"TRUE":return!0;case"FALSE":return!1;default:return!1}},toICAL:function(h){return h?"TRUE":"FALSE"}},float:{matches:/^[+-]?\d+\.\d+$/,fromICAL:function(h){var T=parseFloat(h);return n.helpers.isStrictlyNaN(T)?0:T},toICAL:function(h){return String(h)}},integer:{fromICAL:function(h){var T=parseInt(h);return n.helpers.isStrictlyNaN(T)?0:T},toICAL:function(h){return String(h)}},"utc-offset":{toICAL:function(h){return h.length<7?h.substr(0,3)+h.substr(4,2):h.substr(0,3)+h.substr(4,2)+h.substr(7,2)},fromICAL:function(h){return h.length<6?h.substr(0,3)+":"+h.substr(3,2):h.substr(0,3)+":"+h.substr(3,2)+":"+h.substr(5,2)},decorate:function(h){return n.UtcOffset.fromString(h)},undecorate:function(h){return h.toString()}}},b={cutype:{values:["INDIVIDUAL","GROUP","RESOURCE","ROOM","UNKNOWN"],allowXName:!0,allowIanaToken:!0},"delegated-from":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},"delegated-to":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},encoding:{values:["8BIT","BASE64"]},fbtype:{values:["FREE","BUSY","BUSY-UNAVAILABLE","BUSY-TENTATIVE"],allowXName:!0,allowIanaToken:!0},member:{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},partstat:{values:["NEEDS-ACTION","ACCEPTED","DECLINED","TENTATIVE","DELEGATED","COMPLETED","IN-PROCESS"],allowXName:!0,allowIanaToken:!0},range:{values:["THISANDFUTURE"]},related:{values:["START","END"]},reltype:{values:["PARENT","CHILD","SIBLING"],allowXName:!0,allowIanaToken:!0},role:{values:["REQ-PARTICIPANT","CHAIR","OPT-PARTICIPANT","NON-PARTICIPANT"],allowXName:!0,allowIanaToken:!0},rsvp:{values:["TRUE","FALSE"]},"sent-by":{valueType:"cal-address"},tzid:{matches:/^\//},value:{values:["binary","boolean","cal-address","date","date-time","duration","float","integer","period","recur","text","time","uri","utc-offset"],allowXName:!0,allowIanaToken:!0}},g=n.helpers.extend(D,{text:t(o,r),uri:{},binary:{decorate:function(h){return n.Binary.fromString(h)},undecorate:function(h){return h.toString()}},"cal-address":{},date:{decorate:function(h,T){return P.strict?n.Time.fromDateString(h,T):n.Time.fromString(h,T)},undecorate:function(h){return h.toString()},fromICAL:function(h){return!P.strict&&h.length>=15?g["date-time"].fromICAL(h):h.substr(0,4)+"-"+h.substr(4,2)+"-"+h.substr(6,2)},toICAL:function(h){var T=h.length;return T==10?h.substr(0,4)+h.substr(5,2)+h.substr(8,2):T>=19?g["date-time"].toICAL(h):h}},"date-time":{fromICAL:function(h){if(!P.strict&&h.length==8)return g.date.fromICAL(h);var T=h.substr(0,4)+"-"+h.substr(4,2)+"-"+h.substr(6,2)+"T"+h.substr(9,2)+":"+h.substr(11,2)+":"+h.substr(13,2);return h[15]&&h[15]==="Z"&&(T+="Z"),T},toICAL:function(h){var T=h.length;if(T==10&&!P.strict)return g.date.toICAL(h);if(T>=19){var w=h.substr(0,4)+h.substr(5,2)+h.substr(8,5)+h.substr(14,2)+h.substr(17,2);return h[19]&&h[19]==="Z"&&(w+="Z"),w}else return h},decorate:function(h,T){return P.strict?n.Time.fromDateTimeString(h,T):n.Time.fromString(h,T)},undecorate:function(h){return h.toString()}},duration:{decorate:function(h){return n.Duration.fromString(h)},undecorate:function(h){return h.toString()}},period:{fromICAL:function(h){var T=h.split("/");return T[0]=g["date-time"].fromICAL(T[0]),n.Duration.isValueString(T[1])||(T[1]=g["date-time"].fromICAL(T[1])),T},toICAL:function(h){return!P.strict&&h[0].length==10?h[0]=g.date.toICAL(h[0]):h[0]=g["date-time"].toICAL(h[0]),n.Duration.isValueString(h[1])||(!P.strict&&h[1].length==10?h[1]=g.date.toICAL(h[1]):h[1]=g["date-time"].toICAL(h[1])),h.join("/")},decorate:function(h,T){return n.Period.fromJSON(h,T,!P.strict)},undecorate:function(h){return h.toJSON()}},recur:{fromICAL:function(h){return n.Recur._stringToData(h,!0)},toICAL:function(h){var T="";for(var w in h)if(!!Object.prototype.hasOwnProperty.call(h,w)){var Y=h[w];w=="until"?Y.length>10?Y=g["date-time"].toICAL(Y):Y=g.date.toICAL(Y):w=="wkst"?typeof Y=="number"&&(Y=n.Recur.numericDayToIcalDay(Y)):Array.isArray(Y)&&(Y=Y.join(",")),T+=w.toUpperCase()+"="+Y+";"}return T.substr(0,T.length-1)},decorate:function(T){return n.Recur.fromData(T)},undecorate:function(h){return h.toJSON()}},time:{fromICAL:function(h){if(h.length<6)return h;var T=h.substr(0,2)+":"+h.substr(2,2)+":"+h.substr(4,2);return h[6]==="Z"&&(T+="Z"),T},toICAL:function(h){if(h.length<8)return h;var T=h.substr(0,2)+h.substr(3,2)+h.substr(6,2);return h[8]==="Z"&&(T+="Z"),T}}}),O=n.helpers.extend(A,{action:s,attach:{defaultType:"uri"},attendee:{defaultType:"cal-address"},calscale:s,class:s,comment:s,completed:f,contact:s,created:f,description:s,dtend:v,dtstamp:f,dtstart:v,due:v,duration:{defaultType:"duration"},exdate:{defaultType:"date-time",allowedTypes:["date-time","date"],multiValue:","},exrule:m,freebusy:{defaultType:"period",multiValue:","},geo:{defaultType:"float",structuredValue:";"},"last-modified":f,location:s,method:s,organizer:{defaultType:"cal-address"},"percent-complete":c,priority:c,prodid:s,"related-to":s,repeat:c,rdate:{defaultType:"date-time",allowedTypes:["date-time","date","period"],multiValue:",",detectType:function(h){return h.indexOf("/")!==-1?"period":h.indexOf("T")===-1?"date":"date-time"}},"recurrence-id":v,resources:a,"request-status":u,rrule:m,sequence:c,status:s,summary:s,transp:s,trigger:{defaultType:"duration",allowedTypes:["duration","date-time"]},tzoffsetfrom:l,tzoffsetto:l,tzurl:d,tzid:s,tzname:s}),E=n.helpers.extend(D,{text:t(e,i),uri:t(e,i),date:{decorate:function(h){return n.VCardTime.fromDateAndOrTimeString(h,"date")},undecorate:function(h){return h.toString()},fromICAL:function(h){return h.length==8?g.date.fromICAL(h):h[0]=="-"&&h.length==6?h.substr(0,4)+"-"+h.substr(4):h},toICAL:function(h){return h.length==10?g.date.toICAL(h):h[0]=="-"&&h.length==7?h.substr(0,4)+h.substr(5):h}},time:{decorate:function(h){return n.VCardTime.fromDateAndOrTimeString("T"+h,"time")},undecorate:function(h){return h.toString()},fromICAL:function(h){var T=E.time._splitZone(h,!0),w=T[0],Y=T[1];return Y.length==6?Y=Y.substr(0,2)+":"+Y.substr(2,2)+":"+Y.substr(4,2):Y.length==4&&Y[0]!="-"?Y=Y.substr(0,2)+":"+Y.substr(2,2):Y.length==5&&(Y=Y.substr(0,3)+":"+Y.substr(3,2)),w.length==5&&(w[0]=="-"||w[0]=="+")&&(w=w.substr(0,3)+":"+w.substr(3)),Y+w},toICAL:function(h){var T=E.time._splitZone(h),w=T[0],Y=T[1];return Y.length==8?Y=Y.substr(0,2)+Y.substr(3,2)+Y.substr(6,2):Y.length==5&&Y[0]!="-"?Y=Y.substr(0,2)+Y.substr(3,2):Y.length==6&&(Y=Y.substr(0,3)+Y.substr(4,2)),w.length==6&&(w[0]=="-"||w[0]=="+")&&(w=w.substr(0,3)+w.substr(4)),Y+w},_splitZone:function(h,T){var w=h.length-1,Y=h.length-(T?5:6),R=h[Y],L,k;return h[w]=="Z"?(L=h[w],k=h.substr(0,w)):h.length>6&&(R=="-"||R=="+")?(L=h.substr(Y),k=h.substr(0,Y)):(L="",k=h),[L,k]}},"date-time":{decorate:function(h){return n.VCardTime.fromDateAndOrTimeString(h,"date-time")},undecorate:function(h){return h.toString()},fromICAL:function(h){return E["date-and-or-time"].fromICAL(h)},toICAL:function(h){return E["date-and-or-time"].toICAL(h)}},"date-and-or-time":{decorate:function(h){return n.VCardTime.fromDateAndOrTimeString(h,"date-and-or-time")},undecorate:function(h){return h.toString()},fromICAL:function(h){var T=h.split("T");return(T[0]?E.date.fromICAL(T[0]):"")+(T[1]?"T"+E.time.fromICAL(T[1]):"")},toICAL:function(h){var T=h.split("T");return E.date.toICAL(T[0])+(T[1]?"T"+E.time.toICAL(T[1]):"")}},timestamp:g["date-time"],"language-tag":{matches:/^[a-zA-Z0-9-]+$/}}),C={type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","time","date-time","date-and-or-time","timestamp","boolean","integer","float","utc-offset","language-tag"],allowXName:!0,allowIanaToken:!0}},N=n.helpers.extend(A,{adr:{defaultType:"text",structuredValue:";",multiValue:","},anniversary:y,bday:y,caladruri:d,caluri:d,clientpidmap:u,email:s,fburl:d,fn:s,gender:u,geo:d,impp:d,key:d,kind:s,lang:{defaultType:"language-tag"},logo:d,member:d,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:a,note:s,org:{defaultType:"text",structuredValue:";"},photo:d,related:d,rev:{defaultType:"timestamp"},role:s,sound:d,source:d,tel:{defaultType:"uri",allowedTypes:["uri","text"]},title:s,tz:{defaultType:"text",allowedTypes:["text","utc-offset","uri"]},xml:s}),z=n.helpers.extend(D,{binary:g.binary,date:E.date,"date-time":E["date-time"],"phone-number":{},uri:g.uri,text:g.text,time:g.time,vcard:g.text,"utc-offset":{toICAL:function(h){return h.substr(0,7)},fromICAL:function(h){return h.substr(0,7)},decorate:function(h){return n.UtcOffset.fromString(h)},undecorate:function(h){return h.toString()}}}),x={type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","date-time","phone-number","time","boolean","integer","float","utc-offset","vcard","binary"],allowXName:!0,allowIanaToken:!0}},B=n.helpers.extend(A,{fn:s,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:a,photo:{defaultType:"binary",allowedTypes:["binary","uri"]},bday:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(h){return h.indexOf("T")===-1?"date":"date-time"}},adr:{defaultType:"text",structuredValue:";",multiValue:","},label:s,tel:{defaultType:"phone-number"},email:s,mailer:s,tz:{defaultType:"utc-offset",allowedTypes:["utc-offset","text"]},geo:{defaultType:"float",structuredValue:";"},title:s,role:s,logo:{defaultType:"binary",allowedTypes:["binary","uri"]},agent:{defaultType:"vcard",allowedTypes:["vcard","text","uri"]},org:u,note:a,prodid:s,rev:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(h){return h.indexOf("T")===-1?"date":"date-time"}},"sort-string":s,sound:{defaultType:"binary",allowedTypes:["binary","uri"]},class:s,key:{defaultType:"binary",allowedTypes:["binary","text"]}}),I={value:g,param:b,property:O},M={value:E,param:C,property:N},S={value:z,param:x,property:B},P={strict:!0,defaultSet:I,defaultType:"unknown",components:{vcard:M,vcard3:S,vevent:I,vtodo:I,vjournal:I,valarm:I,vtimezone:I,daylight:I,standard:I},icalendar:I,vcard:M,vcard3:S,getDesignSet:function(h){var T=h&&h in P.components;return T?P.components[h]:P.defaultSet}};return P}();n.stringify=function(){"use strict";var o=`\r
`,r="unknown",e=n.design,i=n.helpers;function t(a){typeof a[0]=="string"&&(a=[a]);for(var u=0,c=a.length,v="";u<c;u++)v+=t.component(a[u])+o;return v}t.component=function(a,u){var c=a[0].toUpperCase(),v="BEGIN:"+c+o,f=a[1],d=0,l=f.length,m=a[0];for(m==="vcard"&&a[1].length>0&&!(a[1][0][0]==="version"&&a[1][0][3]==="4.0")&&(m="vcard3"),u=u||e.getDesignSet(m);d<l;d++)v+=t.property(f[d],u)+o;for(var y=a[2]||[],p=0,_=y.length;p<_;p++)v+=t.component(y[p],u)+o;return v+="END:"+c,v},t.property=function(a,u,c){var v=a[0].toUpperCase(),f=a[0],d=a[1],l=v,m;for(m in d){var y=d[m];if(d.hasOwnProperty(m)){var A=m in u.param&&u.param[m].multiValue;A&&Array.isArray(y)?(u.param[m].multiValueSeparateDQuote&&(A='"'+A+'"'),y=y.map(t._rfc6868Unescape),y=t.multiValue(y,A,"unknown",null,u)):y=t._rfc6868Unescape(y),l+=";"+m.toUpperCase(),l+="="+t.propertyValue(y)}}if(a.length===3)return l+":";var p=a[2];u||(u=e.defaultSet);var _,A=!1,D=!1,b=!1;return f in u.property?(_=u.property[f],"multiValue"in _&&(A=_.multiValue),"structuredValue"in _&&Array.isArray(a[3])&&(D=_.structuredValue),"defaultType"in _?p===_.defaultType&&(b=!0):p===r&&(b=!0)):p===r&&(b=!0),b||(l+=";VALUE="+p.toUpperCase()),l+=":",A&&D?l+=t.multiValue(a[3],D,p,A,u,D):A?l+=t.multiValue(a.slice(3),A,p,null,u,!1):D?l+=t.multiValue(a[3],D,p,null,u,D):l+=t.value(a[3],p,u,!1),c?l:n.helpers.foldline(l)},t.propertyValue=function(a){return i.unescapedIndexOf(a,",")===-1&&i.unescapedIndexOf(a,":")===-1&&i.unescapedIndexOf(a,";")===-1?a:'"'+a+'"'},t.multiValue=function(a,u,c,v,f,d){for(var l="",m=a.length,y=0;y<m;y++)v&&Array.isArray(a[y])?l+=t.multiValue(a[y],v,c,null,f,d):l+=t.value(a[y],c,f,d),y!==m-1&&(l+=u);return l},t.value=function(a,u,c,v){return u in c.value&&"toICAL"in c.value[u]?c.value[u].toICAL(a,v):a},t._rfc6868Unescape=function(a){return a.replace(/[\n^"]/g,function(u){return s[u]})};var s={'"':"^'","\n":"^n","^":"^^"};return t}();n.parse=function(){"use strict";var o=/[^ \t]/,r=",",e=":",i=";",t="=",s="unknown",a="text",u=n.design,c=n.helpers;function v(l){this.message=l,this.name="ParserError";try{throw new Error}catch(y){if(y.stack){var m=y.stack.split(`
`);m.shift(),this.stack=m.join(`
`)}}}v.prototype=Error.prototype;function f(l){var m={},y=m.component=[];if(m.stack=[y],f._eachLine(l,function(p,_){f._handleContentLine(_,m)}),m.stack.length>1)throw new v("invalid ical body. component began but did not end");return m=null,y.length==1?y[0]:y}f.property=function(l,m){var y={component:[[],[]],designSet:m||u.defaultSet};return f._handleContentLine(l,y),y.component[1][0]},f.component=function(l){return f(l)},f.ParserError=v,f._handleContentLine=function(l,m){var y=l.indexOf(e),p=l.indexOf(i),_,A,D,b,g={};p!==-1&&y!==-1&&p>y&&(p=-1);var O;if(p!==-1){if(D=l.substring(0,p).toLowerCase(),O=f._parseParameters(l.substring(p),0,m.designSet),O[2]==-1)throw new v("Invalid parameters in '"+l+"'");if(g=O[0],_=O[1].length+O[2]+p,(A=l.substring(_).indexOf(e))!==-1)b=l.substring(_+A+1);else throw new v("Missing parameter value in '"+l+"'")}else if(y!==-1){if(D=l.substring(0,y).toLowerCase(),b=l.substring(y+1),D==="begin"){var E=[b.toLowerCase(),[],[]];m.stack.length===1?m.component.push(E):m.component[2].push(E),m.stack.push(m.component),m.component=E,m.designSet||(m.designSet=u.getDesignSet(m.component[0]));return}else if(D==="end"){m.component=m.stack.pop();return}}else throw new v('invalid line (no token ";" or ":") "'+l+'"');var C,N=!1,z=!1,x;D in m.designSet.property&&(x=m.designSet.property[D],"multiValue"in x&&(N=x.multiValue),"structuredValue"in x&&(z=x.structuredValue),b&&"detectType"in x&&(C=x.detectType(b))),C||("value"in g?C=g.value.toLowerCase():x?C=x.defaultType:C=s),delete g.value;var B;N&&z?(b=f._parseMultiValue(b,z,C,[],N,m.designSet,z),B=[D,g,C,b]):N?(B=[D,g,C],f._parseMultiValue(b,N,C,B,null,m.designSet,!1)):z?(b=f._parseMultiValue(b,z,C,[],null,m.designSet,z),B=[D,g,C,b]):(b=f._parseValue(b,C,m.designSet,!1),B=[D,g,C,b]),m.component[0]==="vcard"&&m.component[1].length===0&&!(D==="version"&&b==="4.0")&&(m.designSet=u.getDesignSet("vcard3")),m.component[1].push(B)},f._parseValue=function(l,m,y,p){return m in y.value&&"fromICAL"in y.value[m]?y.value[m].fromICAL(l,p):l},f._parseParameters=function(l,m,y){for(var p=m,_=0,A=t,D={},b,g,O,E=-1,C,N,z;_!==!1&&(_=c.unescapedIndexOf(l,A,_+1))!==-1;){if(b=l.substr(p+1,_-p-1),b.length==0)throw new v("Empty parameter name in '"+l+"'");g=b.toLowerCase(),z=!1,N=!1,g in y.param&&y.param[g].valueType?C=y.param[g].valueType:C=a,g in y.param&&(N=y.param[g].multiValue,y.param[g].multiValueSeparateDQuote&&(z=f._rfc6868Escape('"'+N+'"')));var x=l[_+1];if(x==='"'){if(E=_+2,_=c.unescapedIndexOf(l,'"',E),N&&_!=-1)for(var B=!0;B;)l[_+1]==N&&l[_+2]=='"'?_=c.unescapedIndexOf(l,'"',_+3):B=!1;if(_===-1)throw new v('invalid line (no matching double quote) "'+l+'"');O=l.substr(E,_-E),p=c.unescapedIndexOf(l,i,_),p===-1&&(_=!1)}else{E=_+1;var I=c.unescapedIndexOf(l,i,E),M=c.unescapedIndexOf(l,e,E);M!==-1&&I>M?(I=M,_=!1):I===-1?(M===-1?I=l.length:I=M,_=!1):(p=I,_=I),O=l.substr(E,I-E)}if(O=f._rfc6868Escape(O),N){var S=z||N;O=f._parseMultiValue(O,S,C,[],null,y)}else O=f._parseValue(O,C,y);N&&g in D?Array.isArray(D[g])?D[g].push(O):D[g]=[D[g],O]:D[g]=O}return[D,O,E]},f._rfc6868Escape=function(l){return l.replace(/\^['n^]/g,function(m){return d[m]})};var d={"^'":'"',"^n":`
`,"^^":"^"};return f._parseMultiValue=function(l,m,y,p,_,A,D){var b=0,g=0,O;if(m.length===0)return l;for(;(b=c.unescapedIndexOf(l,m,g))!==-1;)O=l.substr(g,b-g),_?O=f._parseMultiValue(O,_,y,[],null,A,D):O=f._parseValue(O,y,A,D),p.push(O),g=b+m.length;return O=l.substr(g),_?O=f._parseMultiValue(O,_,y,[],null,A,D):O=f._parseValue(O,y,A,D),p.push(O),p.length==1?p[0]:p},f._eachLine=function(l,m){var y=l.length,p=l.search(o),_=p,A,D,b;do _=l.indexOf(`
`,p)+1,_>1&&l[_-2]==="\r"?b=2:b=1,_===0&&(_=y,b=0),D=l[p],D===" "||D==="	"?A+=l.substr(p+1,_-p-(b+1)):(A&&m(null,A),A=l.substr(p,_-p-b)),p=_;while(_!==y);A=A.trim(),A.length&&m(null,A)},f}();n.Component=function(){"use strict";var o=1,r=2,e=0;function i(t,s){typeof t=="string"&&(t=[t,[],[]]),this.jCal=t,this.parent=s||null}return i.prototype={_hydratedPropertyCount:0,_hydratedComponentCount:0,get name(){return this.jCal[e]},get _designSet(){var t=this.parent&&this.parent._designSet;return t||n.design.getDesignSet(this.name)},_hydrateComponent:function(t){if(this._components||(this._components=[],this._hydratedComponentCount=0),this._components[t])return this._components[t];var s=new i(this.jCal[r][t],this);return this._hydratedComponentCount++,this._components[t]=s},_hydrateProperty:function(t){if(this._properties||(this._properties=[],this._hydratedPropertyCount=0),this._properties[t])return this._properties[t];var s=new n.Property(this.jCal[o][t],this);return this._hydratedPropertyCount++,this._properties[t]=s},getFirstSubcomponent:function(t){if(t){for(var s=0,a=this.jCal[r],u=a.length;s<u;s++)if(a[s][e]===t){var c=this._hydrateComponent(s);return c}}else if(this.jCal[r].length)return this._hydrateComponent(0);return null},getAllSubcomponents:function(t){var s=this.jCal[r].length,a=0;if(t){for(var u=this.jCal[r],c=[];a<s;a++)t===u[a][e]&&c.push(this._hydrateComponent(a));return c}else{if(!this._components||this._hydratedComponentCount!==s)for(;a<s;a++)this._hydrateComponent(a);return this._components||[]}},hasProperty:function(t){for(var s=this.jCal[o],a=s.length,u=0;u<a;u++)if(s[u][e]===t)return!0;return!1},getFirstProperty:function(t){if(t){for(var s=0,a=this.jCal[o],u=a.length;s<u;s++)if(a[s][e]===t){var c=this._hydrateProperty(s);return c}}else if(this.jCal[o].length)return this._hydrateProperty(0);return null},getFirstPropertyValue:function(t){var s=this.getFirstProperty(t);return s?s.getFirstValue():null},getAllProperties:function(t){var s=this.jCal[o].length,a=0;if(t){for(var u=this.jCal[o],c=[];a<s;a++)t===u[a][e]&&c.push(this._hydrateProperty(a));return c}else{if(!this._properties||this._hydratedPropertyCount!==s)for(;a<s;a++)this._hydrateProperty(a);return this._properties||[]}},_removeObjectByIndex:function(t,s,a){if(s=s||[],s[a]){var u=s[a];"parent"in u&&(u.parent=null)}s.splice(a,1),this.jCal[t].splice(a,1)},_removeObject:function(t,s,a){var u=0,c=this.jCal[t],v=c.length,f=this[s];if(typeof a=="string"){for(;u<v;u++)if(c[u][e]===a)return this._removeObjectByIndex(t,f,u),!0}else if(f){for(;u<v;u++)if(f[u]&&f[u]===a)return this._removeObjectByIndex(t,f,u),!0}return!1},_removeAllObjects:function(t,s,a){for(var u=this[s],c=this.jCal[t],v=c.length-1;v>=0;v--)(!a||c[v][e]===a)&&this._removeObjectByIndex(t,u,v)},addSubcomponent:function(t){this._components||(this._components=[],this._hydratedComponentCount=0),t.parent&&t.parent.removeSubcomponent(t);var s=this.jCal[r].push(t.jCal);return this._components[s-1]=t,this._hydratedComponentCount++,t.parent=this,t},removeSubcomponent:function(t){var s=this._removeObject(r,"_components",t);return s&&this._hydratedComponentCount--,s},removeAllSubcomponents:function(t){var s=this._removeAllObjects(r,"_components",t);return this._hydratedComponentCount=0,s},addProperty:function(t){if(!(t instanceof n.Property))throw new TypeError("must instance of ICAL.Property");this._properties||(this._properties=[],this._hydratedPropertyCount=0),t.parent&&t.parent.removeProperty(t);var s=this.jCal[o].push(t.jCal);return this._properties[s-1]=t,this._hydratedPropertyCount++,t.parent=this,t},addPropertyWithValue:function(t,s){var a=new n.Property(t);return a.setValue(s),this.addProperty(a),a},updatePropertyWithValue:function(t,s){var a=this.getFirstProperty(t);return a?a.setValue(s):a=this.addPropertyWithValue(t,s),a},removeProperty:function(t){var s=this._removeObject(o,"_properties",t);return s&&this._hydratedPropertyCount--,s},removeAllProperties:function(t){var s=this._removeAllObjects(o,"_properties",t);return this._hydratedPropertyCount=0,s},toJSON:function(){return this.jCal},toString:function(){return n.stringify.component(this.jCal,this._designSet)}},i.fromString=function(t){return new i(n.parse.component(t))},i}();n.Property=function(){"use strict";var o=0,r=1,e=2,i=3,t=n.design;function s(a,u){this._parent=u||null,typeof a=="string"?(this.jCal=[a,{},t.defaultType],this.jCal[e]=this.getDefaultType()):this.jCal=a,this._updateType()}return s.prototype={get type(){return this.jCal[e]},get name(){return this.jCal[o]},get parent(){return this._parent},set parent(a){var u=!this._parent||a&&a._designSet!=this._parent._designSet;return this._parent=a,this.type==t.defaultType&&u&&(this.jCal[e]=this.getDefaultType(),this._updateType()),a},get _designSet(){return this.parent?this.parent._designSet:t.defaultSet},_updateType:function(){var a=this._designSet;if(this.type in a.value){var u=a.value[this.type];"decorate"in a.value[this.type]?this.isDecorated=!0:this.isDecorated=!1,this.name in a.property&&(this.isMultiValue="multiValue"in a.property[this.name],this.isStructuredValue="structuredValue"in a.property[this.name])}},_hydrateValue:function(a){return this._values&&this._values[a]?this._values[a]:this.jCal.length<=i+a?null:this.isDecorated?(this._values||(this._values=[]),this._values[a]=this._decorate(this.jCal[i+a])):this.jCal[i+a]},_decorate:function(a){return this._designSet.value[this.type].decorate(a,this)},_undecorate:function(a){return this._designSet.value[this.type].undecorate(a,this)},_setDecoratedValue:function(a,u){this._values||(this._values=[]),typeof a=="object"&&"icaltype"in a?(this.jCal[i+u]=this._undecorate(a),this._values[u]=a):(this.jCal[i+u]=a,this._values[u]=this._decorate(a))},getParameter:function(a){if(a in this.jCal[r])return this.jCal[r][a]},getFirstParameter:function(a){var u=this.getParameter(a);return Array.isArray(u)?u[0]:u},setParameter:function(a,u){var c=a.toLowerCase();typeof u=="string"&&c in this._designSet.param&&"multiValue"in this._designSet.param[c]&&(u=[u]),this.jCal[r][a]=u},removeParameter:function(a){delete this.jCal[r][a]},getDefaultType:function(){var a=this.jCal[o],u=this._designSet;if(a in u.property){var c=u.property[a];if("defaultType"in c)return c.defaultType}return t.defaultType},resetType:function(a){this.removeAllValues(),this.jCal[e]=a,this._updateType()},getFirstValue:function(){return this._hydrateValue(0)},getValues:function(){var a=this.jCal.length-i;if(a<1)return[];for(var u=0,c=[];u<a;u++)c[u]=this._hydrateValue(u);return c},removeAllValues:function(){this._values&&(this._values.length=0),this.jCal.length=3},setValues:function(a){if(!this.isMultiValue)throw new Error(this.name+`: does not not support mulitValue.
override isMultiValue`);var u=a.length,c=0;if(this.removeAllValues(),u>0&&typeof a[0]=="object"&&"icaltype"in a[0]&&this.resetType(a[0].icaltype),this.isDecorated)for(;c<u;c++)this._setDecoratedValue(a[c],c);else for(;c<u;c++)this.jCal[i+c]=a[c]},setValue:function(a){this.removeAllValues(),typeof a=="object"&&"icaltype"in a&&this.resetType(a.icaltype),this.isDecorated?this._setDecoratedValue(a,0):this.jCal[i]=a},toJSON:function(){return this.jCal},toICALString:function(){return n.stringify.property(this.jCal,this._designSet,!0)}},s.fromString=function(a,u){return new s(n.parse.property(a,u))},s}();n.UtcOffset=function(){function o(r){this.fromData(r)}return o.prototype={hours:0,minutes:0,factor:1,icaltype:"utc-offset",clone:function(){return n.UtcOffset.fromSeconds(this.toSeconds())},fromData:function(r){if(r)for(var e in r)r.hasOwnProperty(e)&&(this[e]=r[e]);this._normalize()},fromSeconds:function(r){var e=Math.abs(r);return this.factor=r<0?-1:1,this.hours=n.helpers.trunc(e/3600),e-=this.hours*3600,this.minutes=n.helpers.trunc(e/60),this},toSeconds:function(){return this.factor*(60*this.minutes+3600*this.hours)},compare:function(e){var i=this.toSeconds(),t=e.toSeconds();return(i>t)-(t>i)},_normalize:function(){for(var r=this.toSeconds(),e=this.factor;r<-43200;)r+=97200;for(;r>50400;)r-=97200;this.fromSeconds(r),r==0&&(this.factor=e)},toICALString:function(){return n.design.icalendar.value["utc-offset"].toICAL(this.toString())},toString:function(){return(this.factor==1?"+":"-")+n.helpers.pad2(this.hours)+":"+n.helpers.pad2(this.minutes)}},o.fromString=function(r){var e={};return e.factor=r[0]==="+"?1:-1,e.hours=n.helpers.strictParseInt(r.substr(1,2)),e.minutes=n.helpers.strictParseInt(r.substr(4,2)),new n.UtcOffset(e)},o.fromSeconds=function(r){var e=new o;return e.fromSeconds(r),e},o}();n.Binary=function(){function o(r){this.value=r}return o.prototype={icaltype:"binary",decodeValue:function(){return this._b64_decode(this.value)},setEncodedValue:function(e){this.value=this._b64_encode(e)},_b64_encode:function(e){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t,s,a,u,c,v,f,d,l=0,m=0,y="",p=[];if(!e)return e;do t=e.charCodeAt(l++),s=e.charCodeAt(l++),a=e.charCodeAt(l++),d=t<<16|s<<8|a,u=d>>18&63,c=d>>12&63,v=d>>6&63,f=d&63,p[m++]=i.charAt(u)+i.charAt(c)+i.charAt(v)+i.charAt(f);while(l<e.length);y=p.join("");var _=e.length%3;return(_?y.slice(0,_-3):y)+"===".slice(_||3)},_b64_decode:function(e){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t,s,a,u,c,v,f,d,l=0,m=0,y="",p=[];if(!e)return e;e+="";do u=i.indexOf(e.charAt(l++)),c=i.indexOf(e.charAt(l++)),v=i.indexOf(e.charAt(l++)),f=i.indexOf(e.charAt(l++)),d=u<<18|c<<12|v<<6|f,t=d>>16&255,s=d>>8&255,a=d&255,v==64?p[m++]=String.fromCharCode(t):f==64?p[m++]=String.fromCharCode(t,s):p[m++]=String.fromCharCode(t,s,a);while(l<e.length);return y=p.join(""),y},toString:function(){return this.value}},o.fromString=function(r){return new o(r)},o}();(function(){n.Period=function(r){if(this.wrappedJSObject=this,r&&"start"in r){if(r.start&&!(r.start instanceof n.Time))throw new TypeError(".start must be an instance of ICAL.Time");this.start=r.start}if(r&&r.end&&r.duration)throw new Error("cannot accept both end and duration");if(r&&"end"in r){if(r.end&&!(r.end instanceof n.Time))throw new TypeError(".end must be an instance of ICAL.Time");this.end=r.end}if(r&&"duration"in r){if(r.duration&&!(r.duration instanceof n.Duration))throw new TypeError(".duration must be an instance of ICAL.Duration");this.duration=r.duration}},n.Period.prototype={start:null,end:null,duration:null,icalclass:"icalperiod",icaltype:"period",clone:function(){return n.Period.fromData({start:this.start?this.start.clone():null,end:this.end?this.end.clone():null,duration:this.duration?this.duration.clone():null})},getDuration:function(){return this.duration?this.duration:this.end.subtractDate(this.start)},getEnd:function(){if(this.end)return this.end;var o=this.start.clone();return o.addDuration(this.duration),o},toString:function(){return this.start+"/"+(this.end||this.duration)},toJSON:function(){return[this.start.toString(),(this.end||this.duration).toString()]},toICALString:function(){return this.start.toICALString()+"/"+(this.end||this.duration).toICALString()}},n.Period.fromString=function(r,e){var i=r.split("/");if(i.length!==2)throw new Error('Invalid string value: "'+r+'" must contain a "/" char.');var t={start:n.Time.fromDateTimeString(i[0],e)},s=i[1];return n.Duration.isValueString(s)?t.duration=n.Duration.fromString(s):t.end=n.Time.fromDateTimeString(s,e),new n.Period(t)},n.Period.fromData=function(r){return new n.Period(r)},n.Period.fromJSON=function(o,r,e){function i(t,s){return e?n.Time.fromString(t,s):n.Time.fromDateTimeString(t,s)}return n.Duration.isValueString(o[1])?n.Period.fromData({start:i(o[0],r),duration:n.Duration.fromString(o[1])}):n.Period.fromData({start:i(o[0],r),end:i(o[1],r)})}})();(function(){var o=/([PDWHMTS]{1,1})/;n.Duration=function(i){this.wrappedJSObject=this,this.fromData(i)},n.Duration.prototype={weeks:0,days:0,hours:0,minutes:0,seconds:0,isNegative:!1,icalclass:"icalduration",icaltype:"duration",clone:function(){return n.Duration.fromData(this)},toSeconds:function(){var i=this.seconds+60*this.minutes+3600*this.hours+86400*this.days+604800*this.weeks;return this.isNegative?-i:i},fromSeconds:function(i){var t=Math.abs(i);return this.isNegative=i<0,this.days=n.helpers.trunc(t/86400),this.days%7==0?(this.weeks=this.days/7,this.days=0):this.weeks=0,t-=(this.days+7*this.weeks)*86400,this.hours=n.helpers.trunc(t/3600),t-=this.hours*3600,this.minutes=n.helpers.trunc(t/60),t-=this.minutes*60,this.seconds=t,this},fromData:function(i){var t=["weeks","days","hours","minutes","seconds","isNegative"];for(var s in t)if(!!t.hasOwnProperty(s)){var a=t[s];i&&a in i?this[a]=i[a]:this[a]=0}},reset:function(){this.isNegative=!1,this.weeks=0,this.days=0,this.hours=0,this.minutes=0,this.seconds=0},compare:function(i){var t=this.toSeconds(),s=i.toSeconds();return(t>s)-(t<s)},normalize:function(){this.fromSeconds(this.toSeconds())},toString:function(){if(this.toSeconds()==0)return"PT0S";var i="";return this.isNegative&&(i+="-"),i+="P",this.weeks&&(i+=this.weeks+"W"),this.days&&(i+=this.days+"D"),(this.hours||this.minutes||this.seconds)&&(i+="T",this.hours&&(i+=this.hours+"H"),this.minutes&&(i+=this.minutes+"M"),this.seconds&&(i+=this.seconds+"S")),i},toICALString:function(){return this.toString()}},n.Duration.fromSeconds=function(i){return new n.Duration().fromSeconds(i)};function r(e,i,t){var s;switch(e){case"P":i&&i==="-"?t.isNegative=!0:t.isNegative=!1;break;case"D":s="days";break;case"W":s="weeks";break;case"H":s="hours";break;case"M":s="minutes";break;case"S":s="seconds";break;default:return 0}if(s){if(!i&&i!==0)throw new Error('invalid duration value: Missing number before "'+e+'"');var a=parseInt(i,10);if(n.helpers.isStrictlyNaN(a))throw new Error('invalid duration value: Invalid number "'+i+'" before "'+e+'"');t[s]=a}return 1}n.Duration.isValueString=function(e){return e[0]==="P"||e[1]==="P"},n.Duration.fromString=function(i){for(var t=0,s=Object.create(null),a=0;(t=i.search(o))!==-1;){var u=i[t],c=i.substr(0,t);i=i.substr(t+1),a+=r(u,c,s)}if(a<2)throw new Error('invalid duration value: Not enough duration components in "'+i+'"');return new n.Duration(s)},n.Duration.fromData=function(i){return new n.Duration(i)}})();(function(){var o=["tzid","location","tznames","latitude","longitude"];n.Timezone=function(e){this.wrappedJSObject=this,this.fromData(e)},n.Timezone.prototype={tzid:"",location:"",tznames:"",latitude:0,longitude:0,component:null,expandedUntilYear:0,icalclass:"icaltimezone",fromData:function(e){if(this.expandedUntilYear=0,this.changes=[],e instanceof n.Component)this.component=e;else{if(e&&"component"in e)if(typeof e.component=="string"){var i=n.parse(e.component);this.component=new n.Component(i)}else e.component instanceof n.Component?this.component=e.component:this.component=null;for(var t in o)if(o.hasOwnProperty(t)){var s=o[t];e&&s in e&&(this[s]=e[s])}}return this.component instanceof n.Component&&!this.tzid&&(this.tzid=this.component.getFirstPropertyValue("tzid")),this},utcOffset:function(e){if(this==n.Timezone.utcTimezone||this==n.Timezone.localTimezone||(this._ensureCoverage(e.year),!this.changes.length))return 0;for(var i={year:e.year,month:e.month,day:e.day,hour:e.hour,minute:e.minute,second:e.second},t=this._findNearbyChange(i),s=-1,a=1;;){var u=n.helpers.clone(this.changes[t],!0);u.utcOffset<u.prevUtcOffset?n.Timezone.adjust_change(u,0,0,0,u.utcOffset):n.Timezone.adjust_change(u,0,0,0,u.prevUtcOffset);var c=n.Timezone._compare_change_fn(i,u);if(c>=0?s=t:a=-1,a==-1&&s!=-1)break;if(t+=a,t<0)return 0;if(t>=this.changes.length)break}var v=this.changes[s],f=v.utcOffset-v.prevUtcOffset;if(f<0&&s>0){var d=n.helpers.clone(v,!0);if(n.Timezone.adjust_change(d,0,0,0,d.prevUtcOffset),n.Timezone._compare_change_fn(i,d)<0){var l=this.changes[s-1],m=!1;v.is_daylight!=m&&l.is_daylight==m&&(v=l)}}return v.utcOffset},_findNearbyChange:function(e){var i=n.helpers.binsearchInsert(this.changes,e,n.Timezone._compare_change_fn);return i>=this.changes.length?this.changes.length-1:i},_ensureCoverage:function(r){if(n.Timezone._minimumExpansionYear==-1){var e=n.Time.now();n.Timezone._minimumExpansionYear=e.year}var i=r;if(i<n.Timezone._minimumExpansionYear&&(i=n.Timezone._minimumExpansionYear),i+=n.Timezone.EXTRA_COVERAGE,i>n.Timezone.MAX_YEAR&&(i=n.Timezone.MAX_YEAR),!this.changes.length||this.expandedUntilYear<r){for(var t=this.component.getAllSubcomponents(),s=t.length,a=0;a<s;a++)this._expandComponent(t[a],i,this.changes);this.changes.sort(n.Timezone._compare_change_fn),this.expandedUntilYear=i}},_expandComponent:function(r,e,i){if(!r.hasProperty("dtstart")||!r.hasProperty("tzoffsetto")||!r.hasProperty("tzoffsetfrom"))return null;var t=r.getFirstProperty("dtstart").getFirstValue(),s;function a(p){return p.factor*(p.hours*3600+p.minutes*60)}function u(){var p={};return p.is_daylight=r.name=="daylight",p.utcOffset=a(r.getFirstProperty("tzoffsetto").getFirstValue()),p.prevUtcOffset=a(r.getFirstProperty("tzoffsetfrom").getFirstValue()),p}if(!r.hasProperty("rrule")&&!r.hasProperty("rdate"))s=u(),s.year=t.year,s.month=t.month,s.day=t.day,s.hour=t.hour,s.minute=t.minute,s.second=t.second,n.Timezone.adjust_change(s,0,0,0,-s.prevUtcOffset),i.push(s);else{var c=r.getAllProperties("rdate");for(var v in c)if(!!c.hasOwnProperty(v)){var f=c[v],d=f.getFirstValue();s=u(),s.year=d.year,s.month=d.month,s.day=d.day,d.isDate?(s.hour=t.hour,s.minute=t.minute,s.second=t.second,t.zone!=n.Timezone.utcTimezone&&n.Timezone.adjust_change(s,0,0,0,-s.prevUtcOffset)):(s.hour=d.hour,s.minute=d.minute,s.second=d.second,d.zone!=n.Timezone.utcTimezone&&n.Timezone.adjust_change(s,0,0,0,-s.prevUtcOffset)),i.push(s)}var l=r.getFirstProperty("rrule");if(l){l=l.getFirstValue(),s=u(),l.until&&l.until.zone==n.Timezone.utcTimezone&&(l.until.adjust(0,0,0,s.prevUtcOffset),l.until.zone=n.Timezone.localTimezone);for(var m=l.iterator(t),y;(y=m.next())&&(s=u(),!(y.year>e||!y));)s.year=y.year,s.month=y.month,s.day=y.day,s.hour=y.hour,s.minute=y.minute,s.second=y.second,s.isDate=y.isDate,n.Timezone.adjust_change(s,0,0,0,-s.prevUtcOffset),i.push(s)}}return i},toString:function(){return this.tznames?this.tznames:this.tzid}},n.Timezone._compare_change_fn=function(e,i){return e.year<i.year?-1:e.year>i.year?1:e.month<i.month?-1:e.month>i.month?1:e.day<i.day?-1:e.day>i.day?1:e.hour<i.hour?-1:e.hour>i.hour?1:e.minute<i.minute?-1:e.minute>i.minute?1:e.second<i.second?-1:e.second>i.second?1:0},n.Timezone.convert_time=function(e,i,t){if(e.isDate||i.tzid==t.tzid||i==n.Timezone.localTimezone||t==n.Timezone.localTimezone)return e.zone=t,e;var s=i.utcOffset(e);return e.adjust(0,0,0,-s),s=t.utcOffset(e),e.adjust(0,0,0,s),null},n.Timezone.fromData=function(e){var i=new n.Timezone;return i.fromData(e)},n.Timezone.utcTimezone=n.Timezone.fromData({tzid:"UTC"}),n.Timezone.localTimezone=n.Timezone.fromData({tzid:"floating"}),n.Timezone.adjust_change=function(e,i,t,s,a){return n.Time.prototype.adjust.call(e,i,t,s,a,e)},n.Timezone._minimumExpansionYear=-1,n.Timezone.MAX_YEAR=2035,n.Timezone.EXTRA_COVERAGE=5})();n.TimezoneService=function(){var o,r={get count(){return Object.keys(o).length},reset:function(){o=Object.create(null);var e=n.Timezone.utcTimezone;o.Z=e,o.UTC=e,o.GMT=e},has:function(e){return!!o[e]},get:function(e){return o[e]},register:function(e,i){if(e instanceof n.Component&&e.name==="vtimezone"&&(i=new n.Timezone(e),e=i.tzid),i instanceof n.Timezone)o[e]=i;else throw new TypeError("timezone must be ICAL.Timezone or ICAL.Component")},remove:function(e){return delete o[e]}};return r.reset(),r}();(function(){n.Time=function(r,e){this.wrappedJSObject=this;var i=this._time=Object.create(null);i.year=0,i.month=1,i.day=1,i.hour=0,i.minute=0,i.second=0,i.isDate=!1,this.fromData(r,e)},n.Time._dowCache={},n.Time._wnCache={},n.Time.prototype={icalclass:"icaltime",_cachedUnixTime:null,get icaltype(){return this.isDate?"date":"date-time"},zone:null,_pendingNormalization:!1,clone:function(){return new n.Time(this._time,this.zone)},reset:function(){this.fromData(n.Time.epochTime),this.zone=n.Timezone.utcTimezone},resetTo:function(r,e,i,t,s,a,u){this.fromData({year:r,month:e,day:i,hour:t,minute:s,second:a,zone:u})},fromJSDate:function(r,e){return r?e?(this.zone=n.Timezone.utcTimezone,this.year=r.getUTCFullYear(),this.month=r.getUTCMonth()+1,this.day=r.getUTCDate(),this.hour=r.getUTCHours(),this.minute=r.getUTCMinutes(),this.second=r.getUTCSeconds()):(this.zone=n.Timezone.localTimezone,this.year=r.getFullYear(),this.month=r.getMonth()+1,this.day=r.getDate(),this.hour=r.getHours(),this.minute=r.getMinutes(),this.second=r.getSeconds()):this.reset(),this._cachedUnixTime=null,this},fromData:function(r,e){if(r){for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(i==="icaltype")continue;this[i]=r[i]}}if(e&&(this.zone=e),r&&!("isDate"in r)?this.isDate=!("hour"in r):r&&"isDate"in r&&(this.isDate=r.isDate),r&&"timezone"in r){var t=n.TimezoneService.get(r.timezone);this.zone=t||n.Timezone.localTimezone}return r&&"zone"in r&&(this.zone=r.zone),this.zone||(this.zone=n.Timezone.localTimezone),this._cachedUnixTime=null,this},dayOfWeek:function(r){var e=r||n.Time.SUNDAY,i=(this.year<<12)+(this.month<<8)+(this.day<<3)+e;if(i in n.Time._dowCache)return n.Time._dowCache[i];var t=this.day,s=this.month+(this.month<3?12:0),a=this.year-(this.month<3?1:0),u=t+a+n.helpers.trunc((s+1)*26/10)+n.helpers.trunc(a/4);return u+=n.helpers.trunc(a/100)*6+n.helpers.trunc(a/400),u=(u+7-e)%7+1,n.Time._dowCache[i]=u,u},dayOfYear:function(){var r=n.Time.isLeapYear(this.year)?1:0,e=n.Time.daysInYearPassedMonth;return e[r][this.month-1]+this.day},startOfWeek:function(r){var e=r||n.Time.SUNDAY,i=this.clone();return i.day-=(this.dayOfWeek()+7-e)%7,i.isDate=!0,i.hour=0,i.minute=0,i.second=0,i},endOfWeek:function(r){var e=r||n.Time.SUNDAY,i=this.clone();return i.day+=(7-this.dayOfWeek()+e-n.Time.SUNDAY)%7,i.isDate=!0,i.hour=0,i.minute=0,i.second=0,i},startOfMonth:function(){var r=this.clone();return r.day=1,r.isDate=!0,r.hour=0,r.minute=0,r.second=0,r},endOfMonth:function(){var r=this.clone();return r.day=n.Time.daysInMonth(r.month,r.year),r.isDate=!0,r.hour=0,r.minute=0,r.second=0,r},startOfYear:function(){var r=this.clone();return r.day=1,r.month=1,r.isDate=!0,r.hour=0,r.minute=0,r.second=0,r},endOfYear:function(){var r=this.clone();return r.day=31,r.month=12,r.isDate=!0,r.hour=0,r.minute=0,r.second=0,r},startDoyWeek:function(r){var e=r||n.Time.SUNDAY,i=this.dayOfWeek()-e;return i<0&&(i+=7),this.dayOfYear()-i},getDominicalLetter:function(){return n.Time.getDominicalLetter(this.year)},nthWeekDay:function(r,e){var i=n.Time.daysInMonth(this.month,this.year),t,s=e,a=0,u=this.clone();if(s>=0){u.day=1,s!=0&&s--,a=u.day;var c=u.dayOfWeek(),v=r-c;v<0&&(v+=7),a+=v,a-=r,t=r}else{u.day=i;var f=u.dayOfWeek();s++,t=f-r,t<0&&(t+=7),t=i-t}return t+=s*7,a+t},isNthWeekDay:function(o,r){var e=this.dayOfWeek();if(r===0&&e===o)return!0;var i=this.nthWeekDay(o,r);return i===this.day},weekNumber:function(r){var e=(this.year<<12)+(this.month<<8)+(this.day<<3)+r;if(e in n.Time._wnCache)return n.Time._wnCache[e];var i,t=this.clone();t.isDate=!0;var s=this.year;t.month==12&&t.day>25?(i=n.Time.weekOneStarts(s+1,r),t.compare(i)<0?i=n.Time.weekOneStarts(s,r):s++):(i=n.Time.weekOneStarts(s,r),t.compare(i)<0&&(i=n.Time.weekOneStarts(--s,r)));var a=t.subtractDate(i).toSeconds()/86400,u=n.helpers.trunc(a/7)+1;return n.Time._wnCache[e]=u,u},addDuration:function(r){var e=r.isNegative?-1:1,i=this.second,t=this.minute,s=this.hour,a=this.day;i+=e*r.seconds,t+=e*r.minutes,s+=e*r.hours,a+=e*r.days,a+=e*7*r.weeks,this.second=i,this.minute=t,this.hour=s,this.day=a,this._cachedUnixTime=null},subtractDate:function(r){var e=this.toUnixTime()+this.utcOffset(),i=r.toUnixTime()+r.utcOffset();return n.Duration.fromSeconds(e-i)},subtractDateTz:function(r){var e=this.toUnixTime(),i=r.toUnixTime();return n.Duration.fromSeconds(e-i)},compare:function(r){var e=this.toUnixTime(),i=r.toUnixTime();return e>i?1:i>e?-1:0},compareDateOnlyTz:function(r,e){function i(u){return n.Time._cmp_attr(t,s,u)}var t=this.convertToZone(e),s=r.convertToZone(e),a=0;return(a=i("year"))!=0||(a=i("month"))!=0||(a=i("day"))!=0,a},convertToZone:function(r){var e=this.clone(),i=this.zone.tzid==r.tzid;return!this.isDate&&!i&&n.Timezone.convert_time(e,this.zone,r),e.zone=r,e},utcOffset:function(){return this.zone==n.Timezone.localTimezone||this.zone==n.Timezone.utcTimezone?0:this.zone.utcOffset(this)},toICALString:function(){var o=this.toString();return o.length>10?n.design.icalendar.value["date-time"].toICAL(o):n.design.icalendar.value.date.toICAL(o)},toString:function(){var r=this.year+"-"+n.helpers.pad2(this.month)+"-"+n.helpers.pad2(this.day);return this.isDate||(r+="T"+n.helpers.pad2(this.hour)+":"+n.helpers.pad2(this.minute)+":"+n.helpers.pad2(this.second),this.zone===n.Timezone.utcTimezone&&(r+="Z")),r},toJSDate:function(){return this.zone==n.Timezone.localTimezone?this.isDate?new Date(this.year,this.month-1,this.day):new Date(this.year,this.month-1,this.day,this.hour,this.minute,this.second,0):new Date(this.toUnixTime()*1e3)},_normalize:function(){var r=this._time.isDate;return this._time.isDate&&(this._time.hour=0,this._time.minute=0,this._time.second=0),this.adjust(0,0,0,0),this},adjust:function(r,e,i,t,s){var a,u,c=0,v=0,f,d,l,m,y,p=s||this._time;if(p.isDate||(f=p.second+t,p.second=f%60,a=n.helpers.trunc(f/60),p.second<0&&(p.second+=60,a--),d=p.minute+i+a,p.minute=d%60,u=n.helpers.trunc(d/60),p.minute<0&&(p.minute+=60,u--),l=p.hour+e+u,p.hour=l%24,c=n.helpers.trunc(l/24),p.hour<0&&(p.hour+=24,c--)),p.month>12?v=n.helpers.trunc((p.month-1)/12):p.month<1&&(v=n.helpers.trunc(p.month/12)-1),p.year+=v,p.month-=12*v,m=p.day+r+c,m>0)for(;y=n.Time.daysInMonth(p.month,p.year),!(m<=y);)p.month++,p.month>12&&(p.year++,p.month=1),m-=y;else for(;m<=0;)p.month==1?(p.year--,p.month=12):p.month--,m+=n.Time.daysInMonth(p.month,p.year);return p.day=m,this._cachedUnixTime=null,this},fromUnixTime:function(r){this.zone=n.Timezone.utcTimezone;var e=n.Time.epochTime.clone();e.adjust(0,0,0,r),this.year=e.year,this.month=e.month,this.day=e.day,this.hour=e.hour,this.minute=e.minute,this.second=Math.floor(e.second),this._cachedUnixTime=null},toUnixTime:function(){if(this._cachedUnixTime!==null)return this._cachedUnixTime;var r=this.utcOffset(),e=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second-r);return this._cachedUnixTime=e/1e3,this._cachedUnixTime},toJSON:function(){for(var o=["year","month","day","hour","minute","second","isDate"],r=Object.create(null),e=0,i=o.length,t;e<i;e++)t=o[e],r[t]=this[t];return this.zone&&(r.timezone=this.zone.tzid),r}},function(){function r(e){Object.defineProperty(n.Time.prototype,e,{get:function(){return this._pendingNormalization&&(this._normalize(),this._pendingNormalization=!1),this._time[e]},set:function(t){return e==="isDate"&&t&&!this._time.isDate&&this.adjust(0,0,0,0),this._cachedUnixTime=null,this._pendingNormalization=!0,this._time[e]=t,t}})}"defineProperty"in Object&&(r("year"),r("month"),r("day"),r("hour"),r("minute"),r("second"),r("isDate"))}(),n.Time.daysInMonth=function(r,e){var i=[0,31,28,31,30,31,30,31,31,30,31,30,31],t=30;return r<1||r>12||(t=i[r],r==2&&(t+=n.Time.isLeapYear(e))),t},n.Time.isLeapYear=function(r){return r<=1752?r%4==0:r%4==0&&r%100!=0||r%400==0},n.Time.fromDayOfYear=function(r,e){var i=e,t=r,s=new n.Time;s.auto_normalize=!1;var a=n.Time.isLeapYear(i)?1:0;if(t<1)return i--,a=n.Time.isLeapYear(i)?1:0,t+=n.Time.daysInYearPassedMonth[a][12],n.Time.fromDayOfYear(t,i);if(t>n.Time.daysInYearPassedMonth[a][12])return a=n.Time.isLeapYear(i)?1:0,t-=n.Time.daysInYearPassedMonth[a][12],i++,n.Time.fromDayOfYear(t,i);s.year=i,s.isDate=!0;for(var u=11;u>=0;u--)if(t>n.Time.daysInYearPassedMonth[a][u]){s.month=u+1,s.day=t-n.Time.daysInYearPassedMonth[a][u];break}return s.auto_normalize=!0,s},n.Time.fromStringv2=function(r){return new n.Time({year:parseInt(r.substr(0,4),10),month:parseInt(r.substr(5,2),10),day:parseInt(r.substr(8,2),10),isDate:!0})},n.Time.fromDateString=function(o){return new n.Time({year:n.helpers.strictParseInt(o.substr(0,4)),month:n.helpers.strictParseInt(o.substr(5,2)),day:n.helpers.strictParseInt(o.substr(8,2)),isDate:!0})},n.Time.fromDateTimeString=function(o,r){if(o.length<19)throw new Error('invalid date-time value: "'+o+'"');var e;o[19]&&o[19]==="Z"?e="Z":r&&(e=r.getParameter("tzid"));var i=new n.Time({year:n.helpers.strictParseInt(o.substr(0,4)),month:n.helpers.strictParseInt(o.substr(5,2)),day:n.helpers.strictParseInt(o.substr(8,2)),hour:n.helpers.strictParseInt(o.substr(11,2)),minute:n.helpers.strictParseInt(o.substr(14,2)),second:n.helpers.strictParseInt(o.substr(17,2)),timezone:e});return i},n.Time.fromString=function(r,e){return r.length>10?n.Time.fromDateTimeString(r,e):n.Time.fromDateString(r)},n.Time.fromJSDate=function(r,e){var i=new n.Time;return i.fromJSDate(r,e)},n.Time.fromData=function(r,e){var i=new n.Time;return i.fromData(r,e)},n.Time.now=function(){return n.Time.fromJSDate(new Date,!1)},n.Time.weekOneStarts=function(r,e){var i=n.Time.fromData({year:r,month:1,day:1,isDate:!0}),t=i.dayOfWeek(),s=e||n.Time.DEFAULT_WEEK_START;return t>n.Time.THURSDAY&&(i.day+=7),s>n.Time.THURSDAY&&(i.day-=7),i.day-=t-s,i},n.Time.getDominicalLetter=function(o){var r="GFEDCBA",e=(o+(o/4|0)+(o/400|0)-(o/100|0)-1)%7,i=n.Time.isLeapYear(o);return i?r[(e+6)%7]+r[e]:r[e]},n.Time.epochTime=n.Time.fromData({year:1970,month:1,day:1,hour:0,minute:0,second:0,isDate:!1,timezone:"Z"}),n.Time._cmp_attr=function(r,e,i){return r[i]>e[i]?1:r[i]<e[i]?-1:0},n.Time.daysInYearPassedMonth=[[0,31,59,90,120,151,181,212,243,273,304,334,365],[0,31,60,91,121,152,182,213,244,274,305,335,366]],n.Time.SUNDAY=1,n.Time.MONDAY=2,n.Time.TUESDAY=3,n.Time.WEDNESDAY=4,n.Time.THURSDAY=5,n.Time.FRIDAY=6,n.Time.SATURDAY=7,n.Time.DEFAULT_WEEK_START=n.Time.MONDAY})();(function(){n.VCardTime=function(o,r,e){this.wrappedJSObject=this;var i=this._time=Object.create(null);i.year=null,i.month=null,i.day=null,i.hour=null,i.minute=null,i.second=null,this.icaltype=e||"date-and-or-time",this.fromData(o,r)},n.helpers.inherits(n.Time,n.VCardTime,{icalclass:"vcardtime",icaltype:"date-and-or-time",zone:null,clone:function(){return new n.VCardTime(this._time,this.zone,this.icaltype)},_normalize:function(){return this},utcOffset:function(){return this.zone instanceof n.UtcOffset?this.zone.toSeconds():n.Time.prototype.utcOffset.apply(this,arguments)},toICALString:function(){return n.design.vcard.value[this.icaltype].toICAL(this.toString())},toString:function(){var r=n.helpers.pad2,e=this.year,i=this.month,t=this.day,s=this.hour,a=this.minute,u=this.second,c=e!==null,v=i!==null,f=t!==null,d=s!==null,l=a!==null,m=u!==null,y=(c?r(e)+(v||f?"-":""):v||f?"--":"")+(v?r(i):"")+(f?"-"+r(t):""),p=(d?r(s):"-")+(d&&l?":":"")+(l?r(a):"")+(!d&&!l?"-":"")+(l&&m?":":"")+(m?r(u):""),_;if(this.zone===n.Timezone.utcTimezone)_="Z";else if(this.zone instanceof n.UtcOffset)_=this.zone.toString();else if(this.zone===n.Timezone.localTimezone)_="";else if(this.zone instanceof n.Timezone){var A=n.UtcOffset.fromSeconds(this.zone.utcOffset(this));_=A.toString()}else _="";switch(this.icaltype){case"time":return p+_;case"date-and-or-time":case"date-time":return y+(p=="--"?"":"T"+p+_);case"date":return y}return null}}),n.VCardTime.fromDateAndOrTimeString=function(o,r){function e(p,_,A){return p?n.helpers.strictParseInt(p.substr(_,A)):null}var i=o.split("T"),t=i[0],s=i[1],a=s?n.design.vcard.value.time._splitZone(s):[],u=a[0],c=a[1],v=n.helpers.strictParseInt,f=t?t.length:0,d=c?c.length:0,l=t&&t[0]=="-"&&t[1]=="-",m=c&&c[0]=="-",y={year:l?null:e(t,0,4),month:l&&(f==4||f==7)?e(t,2,2):f==7||f==10?e(t,5,2):null,day:f==5?e(t,3,2):f==7&&l?e(t,5,2):f==10?e(t,8,2):null,hour:m?null:e(c,0,2),minute:m&&d==3?e(c,1,2):d>4?m?e(c,1,2):e(c,3,2):null,second:d==4?e(c,2,2):d==6?e(c,4,2):d==8?e(c,6,2):null};return u=="Z"?u=n.Timezone.utcTimezone:u&&u[3]==":"?u=n.UtcOffset.fromString(u):u=null,new n.VCardTime(y,u,r)}})();(function(){var o={SU:n.Time.SUNDAY,MO:n.Time.MONDAY,TU:n.Time.TUESDAY,WE:n.Time.WEDNESDAY,TH:n.Time.THURSDAY,FR:n.Time.FRIDAY,SA:n.Time.SATURDAY},r={};for(var e in o)o.hasOwnProperty(e)&&(r[o[e]]=e);var i=["BYSECOND","BYMINUTE","BYHOUR","BYDAY","BYMONTHDAY","BYYEARDAY","BYWEEKNO","BYMONTH","BYSETPOS"];n.Recur=function(d){this.wrappedJSObject=this,this.parts={},d&&typeof d=="object"&&this.fromData(d)},n.Recur.prototype={parts:null,interval:1,wkst:n.Time.MONDAY,until:null,count:null,freq:null,icalclass:"icalrecur",icaltype:"recur",iterator:function(f){return new n.RecurIterator({rule:this,dtstart:f})},clone:function(){return new n.Recur(this.toJSON())},isFinite:function(){return!!(this.count||this.until)},isByCount:function(){return!!(this.count&&!this.until)},addComponent:function(d,l){var m=d.toUpperCase();m in this.parts?this.parts[m].push(l):this.parts[m]=[l]},setComponent:function(d,l){this.parts[d.toUpperCase()]=l.slice()},getComponent:function(d){var l=d.toUpperCase();return l in this.parts?this.parts[l].slice():[]},getNextOccurrence:function(d,l){var m=this.iterator(d),y,p;do y=m.next();while(y&&y.compare(l)<=0);return y&&l.zone&&(y.zone=l.zone),y},fromData:function(f){for(var d in f){var l=d.toUpperCase();l in v?Array.isArray(f[d])?this.parts[l]=f[d]:this.parts[l]=[f[d]]:this[d]=f[d]}this.interval&&typeof this.interval!="number"&&c.INTERVAL(this.interval,this),this.wkst&&typeof this.wkst!="number"&&(this.wkst=n.Recur.icalDayToNumericDay(this.wkst)),this.until&&!(this.until instanceof n.Time)&&(this.until=n.Time.fromString(this.until))},toJSON:function(){var f=Object.create(null);f.freq=this.freq,this.count&&(f.count=this.count),this.interval>1&&(f.interval=this.interval);for(var d in this.parts)if(!!this.parts.hasOwnProperty(d)){var l=this.parts[d];Array.isArray(l)&&l.length==1?f[d.toLowerCase()]=l[0]:f[d.toLowerCase()]=n.helpers.clone(this.parts[d])}return this.until&&(f.until=this.until.toString()),"wkst"in this&&this.wkst!==n.Time.DEFAULT_WEEK_START&&(f.wkst=n.Recur.numericDayToIcalDay(this.wkst)),f},toString:function(){var d="FREQ="+this.freq;this.count&&(d+=";COUNT="+this.count),this.interval>1&&(d+=";INTERVAL="+this.interval);for(var l in this.parts)this.parts.hasOwnProperty(l)&&(d+=";"+l+"="+this.parts[l]);return this.until&&(d+=";UNTIL="+this.until.toICALString()),"wkst"in this&&this.wkst!==n.Time.DEFAULT_WEEK_START&&(d+=";WKST="+n.Recur.numericDayToIcalDay(this.wkst)),d}};function t(f,d,l,m){var y=m;if(m[0]==="+"&&(y=m.substr(1)),y=n.helpers.strictParseInt(y),d!==void 0&&m<d)throw new Error(f+': invalid value "'+m+'" must be > '+d);if(l!==void 0&&m>l)throw new Error(f+': invalid value "'+m+'" must be < '+d);return y}n.Recur.icalDayToNumericDay=function(d,l){var m=l||n.Time.SUNDAY;return(o[d]-m+7)%7+1},n.Recur.numericDayToIcalDay=function(d,l){var m=l||n.Time.SUNDAY,y=d+m-n.Time.SUNDAY;return y>7&&(y-=7),r[y]};var s=/^(SU|MO|TU|WE|TH|FR|SA)$/,a=/^([+-])?(5[0-3]|[1-4][0-9]|[1-9])?(SU|MO|TU|WE|TH|FR|SA)$/,u=["SECONDLY","MINUTELY","HOURLY","DAILY","WEEKLY","MONTHLY","YEARLY"],c={FREQ:function(f,d,l){if(u.indexOf(f)!==-1)d.freq=f;else throw new Error('invalid frequency "'+f+'" expected: "'+u.join(", ")+'"')},COUNT:function(f,d,l){d.count=n.helpers.strictParseInt(f)},INTERVAL:function(f,d,l){d.interval=n.helpers.strictParseInt(f),d.interval<1&&(d.interval=1)},UNTIL:function(f,d,l){f.length>10?d.until=n.design.icalendar.value["date-time"].fromICAL(f):d.until=n.design.icalendar.value.date.fromICAL(f),l||(d.until=n.Time.fromString(d.until))},WKST:function(f,d,l){if(s.test(f))d.wkst=n.Recur.icalDayToNumericDay(f);else throw new Error('invalid WKST value "'+f+'"')}},v={BYSECOND:t.bind(this,"BYSECOND",0,60),BYMINUTE:t.bind(this,"BYMINUTE",0,59),BYHOUR:t.bind(this,"BYHOUR",0,23),BYDAY:function(f){if(a.test(f))return f;throw new Error('invalid BYDAY value "'+f+'"')},BYMONTHDAY:t.bind(this,"BYMONTHDAY",-31,31),BYYEARDAY:t.bind(this,"BYYEARDAY",-366,366),BYWEEKNO:t.bind(this,"BYWEEKNO",-53,53),BYMONTH:t.bind(this,"BYMONTH",1,12),BYSETPOS:t.bind(this,"BYSETPOS",-366,366)};n.Recur.fromString=function(f){var d=n.Recur._stringToData(f,!1);return new n.Recur(d)},n.Recur.fromData=function(f){return new n.Recur(f)},n.Recur._stringToData=function(f,d){for(var l=Object.create(null),m=f.split(";"),y=m.length,p=0;p<y;p++){var _=m[p].split("="),A=_[0].toUpperCase(),D=_[0].toLowerCase(),b=d?D:A,g=_[1];if(A in v){for(var O=g.split(","),E=0,C=O.length;E<C;E++)O[E]=v[A](O[E]);l[b]=O.length==1?O[0]:O}else A in c?c[A](g,l,d):l[D]=g}return l}})();n.RecurIterator=function(){function o(r){this.fromData(r)}return o.prototype={completed:!1,rule:null,dtstart:null,last:null,occurrence_number:0,by_indices:null,initialized:!1,by_data:null,days:null,days_index:0,fromData:function(r){if(this.rule=n.helpers.formatClassType(r.rule,n.Recur),!this.rule)throw new Error("iterator requires a (ICAL.Recur) rule");if(this.dtstart=n.helpers.formatClassType(r.dtstart,n.Time),!this.dtstart)throw new Error("iterator requires a (ICAL.Time) dtstart");r.by_data?this.by_data=r.by_data:this.by_data=n.helpers.clone(this.rule.parts,!0),r.occurrence_number&&(this.occurrence_number=r.occurrence_number),this.days=r.days||[],r.last&&(this.last=n.helpers.formatClassType(r.last,n.Time)),this.by_indices=r.by_indices,this.by_indices||(this.by_indices={BYSECOND:0,BYMINUTE:0,BYHOUR:0,BYDAY:0,BYMONTH:0,BYWEEKNO:0,BYMONTHDAY:0}),this.initialized=r.initialized||!1,this.initialized||this.init()},init:function(){this.initialized=!0,this.last=this.dtstart.clone();var e=this.by_data;if("BYDAY"in e&&this.sort_byday_rules(e.BYDAY),"BYYEARDAY"in e&&("BYMONTH"in e||"BYWEEKNO"in e||"BYMONTHDAY"in e||"BYDAY"in e))throw new Error("Invalid BYYEARDAY rule");if("BYWEEKNO"in e&&"BYMONTHDAY"in e)throw new Error("BYWEEKNO does not fit to BYMONTHDAY");if(this.rule.freq=="MONTHLY"&&("BYYEARDAY"in e||"BYWEEKNO"in e))throw new Error("For MONTHLY recurrences neither BYYEARDAY nor BYWEEKNO may appear");if(this.rule.freq=="WEEKLY"&&("BYYEARDAY"in e||"BYMONTHDAY"in e))throw new Error("For WEEKLY recurrences neither BYMONTHDAY nor BYYEARDAY may appear");if(this.rule.freq!="YEARLY"&&"BYYEARDAY"in e)throw new Error("BYYEARDAY may only appear in YEARLY rules");if(this.last.second=this.setup_defaults("BYSECOND","SECONDLY",this.dtstart.second),this.last.minute=this.setup_defaults("BYMINUTE","MINUTELY",this.dtstart.minute),this.last.hour=this.setup_defaults("BYHOUR","HOURLY",this.dtstart.hour),this.last.day=this.setup_defaults("BYMONTHDAY","DAILY",this.dtstart.day),this.last.month=this.setup_defaults("BYMONTH","MONTHLY",this.dtstart.month),this.rule.freq=="WEEKLY")if("BYDAY"in e){var i=this.ruleDayOfWeek(e.BYDAY[0],this.rule.wkst),t=i[0],s=i[1],a=s-this.last.dayOfWeek(this.rule.wkst);(this.last.dayOfWeek(this.rule.wkst)<s&&a>=0||a<0)&&(this.last.day+=a)}else{var u=n.Recur.numericDayToIcalDay(this.dtstart.dayOfWeek());e.BYDAY=[u]}if(this.rule.freq=="YEARLY"){for(;this.expand_year_days(this.last.year),!(this.days.length>0);)this.increment_year(this.rule.interval);this._nextByYearDay()}if(this.rule.freq=="MONTHLY"&&this.has_by_data("BYDAY")){var c=null,v=this.last.clone(),f=n.Time.daysInMonth(this.last.month,this.last.year);for(var d in this.by_data.BYDAY)if(!!this.by_data.BYDAY.hasOwnProperty(d)){this.last=v.clone();var i=this.ruleDayOfWeek(this.by_data.BYDAY[d]),t=i[0],s=i[1],l=this.last.nthWeekDay(s,t);if(t>=6||t<=-6)throw new Error("Malformed values in BYDAY part");if(l>f||l<=0){if(c&&c.month==v.month)continue;for(;l>f||l<=0;)this.increment_month(),f=n.Time.daysInMonth(this.last.month,this.last.year),l=this.last.nthWeekDay(s,t)}this.last.day=l,(!c||this.last.compare(c)<0)&&(c=this.last.clone())}if(this.last=c.clone(),this.has_by_data("BYMONTHDAY")&&this._byDayAndMonthDay(!0),this.last.day>f||this.last.day==0)throw new Error("Malformed values in BYDAY part")}else if(this.has_by_data("BYMONTHDAY")&&this.last.day<0){var f=n.Time.daysInMonth(this.last.month,this.last.year);this.last.day=f+this.last.day+1}},next:function(){var e=this.last?this.last.clone():null;if(this.rule.count&&this.occurrence_number>=this.rule.count||this.rule.until&&this.last.compare(this.rule.until)>0)return this.completed=!0,null;if(this.occurrence_number==0&&this.last.compare(this.dtstart)>=0)return this.occurrence_number++,this.last;var i;do switch(i=1,this.rule.freq){case"SECONDLY":this.next_second();break;case"MINUTELY":this.next_minute();break;case"HOURLY":this.next_hour();break;case"DAILY":this.next_day();break;case"WEEKLY":this.next_week();break;case"MONTHLY":i=this.next_month();break;case"YEARLY":this.next_year();break;default:return null}while(!this.check_contracting_rules()||this.last.compare(this.dtstart)<0||!i);if(this.last.compare(e)==0)throw new Error("Same occurrence found twice, protecting you from death by recursion");return this.rule.until&&this.last.compare(this.rule.until)>0?(this.completed=!0,null):(this.occurrence_number++,this.last)},next_second:function(){return this.next_generic("BYSECOND","SECONDLY","second","minute")},increment_second:function(e){return this.increment_generic(e,"second",60,"minute")},next_minute:function(){return this.next_generic("BYMINUTE","MINUTELY","minute","hour","next_second")},increment_minute:function(e){return this.increment_generic(e,"minute",60,"hour")},next_hour:function(){return this.next_generic("BYHOUR","HOURLY","hour","monthday","next_minute")},increment_hour:function(e){this.increment_generic(e,"hour",24,"monthday")},next_day:function(){var e="BYDAY"in this.by_data,i=this.rule.freq=="DAILY";return this.next_hour()==0||(i?this.increment_monthday(this.rule.interval):this.increment_monthday(1)),0},next_week:function(){var e=0;if(this.next_weekday_by_week()==0)return e;if(this.has_by_data("BYWEEKNO")){var i=++this.by_indices.BYWEEKNO;this.by_indices.BYWEEKNO==this.by_data.BYWEEKNO.length&&(this.by_indices.BYWEEKNO=0,e=1),this.last.month=1,this.last.day=1;var t=this.by_data.BYWEEKNO[this.by_indices.BYWEEKNO];this.last.day+=7*t,e&&this.increment_year(1)}else this.increment_monthday(7*this.rule.interval);return e},normalizeByMonthDayRules:function(r,e,i){for(var t=n.Time.daysInMonth(e,r),s=[],a=0,u=i.length,c;a<u;a++)if(c=i[a],!(Math.abs(c)>t)){if(c<0)c=t+(c+1);else if(c===0)continue;s.indexOf(c)===-1&&s.push(c)}return s.sort(function(v,f){return v-f})},_byDayAndMonthDay:function(r){var e,i=this.by_data.BYDAY,t,s=0,a,u=i.length,c=0,v,f=this,d=this.last.day;function l(){for(v=n.Time.daysInMonth(f.last.month,f.last.year),e=f.normalizeByMonthDayRules(f.last.year,f.last.month,f.by_data.BYMONTHDAY),a=e.length;e[s]<=d&&!(r&&e[s]==d)&&s<a-1;)s++}function m(){d=0,f.increment_month(),s=0,l()}l(),r&&(d-=1);for(var y=48;!c&&y;){if(y--,t=d+1,t>v){m();continue}var p=e[s++];if(p>=t)d=p;else{m();continue}for(var _=0;_<u;_++){var A=this.ruleDayOfWeek(i[_]),D=A[0],b=A[1];if(this.last.day=d,this.last.isNthWeekDay(b,D)){c=1;break}}if(!c&&s===a){m();continue}}if(y<=0)throw new Error("Malformed values in BYDAY combined with BYMONTHDAY parts");return c},next_month:function(){var e=this.rule.freq=="MONTHLY",i=1;if(this.next_hour()==0)return i;if(this.has_by_data("BYDAY")&&this.has_by_data("BYMONTHDAY"))i=this._byDayAndMonthDay();else if(this.has_by_data("BYDAY")){var t=n.Time.daysInMonth(this.last.month,this.last.year),s=0,a=0;if(this.has_by_data("BYSETPOS")){for(var u=this.last.day,c=1;c<=t;c++)this.last.day=c,this.is_day_in_byday(this.last)&&(a++,c<=u&&s++);this.last.day=u}i=0;for(var c=this.last.day+1;c<=t;c++)if(this.last.day=c,this.is_day_in_byday(this.last)&&(!this.has_by_data("BYSETPOS")||this.check_set_position(++s)||this.check_set_position(s-a-1))){i=1;break}c>t&&(this.last.day=1,this.increment_month(),this.is_day_in_byday(this.last)?(!this.has_by_data("BYSETPOS")||this.check_set_position(1))&&(i=1):i=0)}else if(this.has_by_data("BYMONTHDAY")){this.by_indices.BYMONTHDAY++,this.by_indices.BYMONTHDAY>=this.by_data.BYMONTHDAY.length&&(this.by_indices.BYMONTHDAY=0,this.increment_month());var t=n.Time.daysInMonth(this.last.month,this.last.year),c=this.by_data.BYMONTHDAY[this.by_indices.BYMONTHDAY];c<0&&(c=t+c+1),c>t?(this.last.day=1,i=this.is_day_in_byday(this.last)):this.last.day=c}else{this.increment_month();var t=n.Time.daysInMonth(this.last.month,this.last.year);this.by_data.BYMONTHDAY[0]>t?i=0:this.last.day=this.by_data.BYMONTHDAY[0]}return i},next_weekday_by_week:function(){var e=0;if(this.next_hour()==0)return e;if(!this.has_by_data("BYDAY"))return 1;for(;;){var i=new n.Time;this.by_indices.BYDAY++,this.by_indices.BYDAY==Object.keys(this.by_data.BYDAY).length&&(this.by_indices.BYDAY=0,e=1);var t=this.by_data.BYDAY[this.by_indices.BYDAY],s=this.ruleDayOfWeek(t),a=s[1];a-=this.rule.wkst,a<0&&(a+=7),i.year=this.last.year,i.month=this.last.month,i.day=this.last.day;var u=i.startDoyWeek(this.rule.wkst);if(!(a+u<1&&!e)){var c=n.Time.fromDayOfYear(u+a,this.last.year);return this.last.year=c.year,this.last.month=c.month,this.last.day=c.day,e}}},next_year:function(){if(this.next_hour()==0)return 0;if(++this.days_index==this.days.length){this.days_index=0;do this.increment_year(this.rule.interval),this.expand_year_days(this.last.year);while(this.days.length==0)}return this._nextByYearDay(),1},_nextByYearDay:function(){var e=this.days[this.days_index],i=this.last.year;e<1&&(e+=1,i+=1);var t=n.Time.fromDayOfYear(e,i);this.last.day=t.day,this.last.month=t.month},ruleDayOfWeek:function(e,i){var t=e.match(/([+-]?[0-9])?(MO|TU|WE|TH|FR|SA|SU)/);if(t){var s=parseInt(t[1]||0,10);return e=n.Recur.icalDayToNumericDay(t[2],i),[s,e]}else return[0,0]},next_generic:function(e,i,t,s,a){var u=e in this.by_data,c=this.rule.freq==i,v=0;if(a&&this[a]()==0)return v;if(u){this.by_indices[e]++;var f=this.by_indices[e],d=this.by_data[e];this.by_indices[e]==d.length&&(this.by_indices[e]=0,v=1),this.last[t]=d[this.by_indices[e]]}else c&&this["increment_"+t](this.rule.interval);return u&&v&&c&&this["increment_"+s](1),v},increment_monthday:function(e){for(var i=0;i<e;i++){var t=n.Time.daysInMonth(this.last.month,this.last.year);this.last.day++,this.last.day>t&&(this.last.day-=t,this.increment_month())}},increment_month:function(){if(this.last.day=1,this.has_by_data("BYMONTH"))this.by_indices.BYMONTH++,this.by_indices.BYMONTH==this.by_data.BYMONTH.length&&(this.by_indices.BYMONTH=0,this.increment_year(1)),this.last.month=this.by_data.BYMONTH[this.by_indices.BYMONTH];else{this.rule.freq=="MONTHLY"?this.last.month+=this.rule.interval:this.last.month++,this.last.month--;var e=n.helpers.trunc(this.last.month/12);this.last.month%=12,this.last.month++,e!=0&&this.increment_year(e)}},increment_year:function(e){this.last.year+=e},increment_generic:function(e,i,t,s){this.last[i]+=e;var a=n.helpers.trunc(this.last[i]/t);this.last[i]%=t,a!=0&&this["increment_"+s](a)},has_by_data:function(e){return e in this.rule.parts},expand_year_days:function(e){var i=new n.Time;this.days=[];var t={},s=["BYDAY","BYWEEKNO","BYMONTHDAY","BYMONTH","BYYEARDAY"];for(var a in s)if(s.hasOwnProperty(a)){var u=s[a];u in this.rule.parts&&(t[u]=this.rule.parts[u])}if("BYMONTH"in t&&"BYWEEKNO"in t){var c=1,v={};i.year=e,i.isDate=!0;for(var f=0;f<this.by_data.BYMONTH.length;f++){var d=this.by_data.BYMONTH[f];i.month=d,i.day=1;var l=i.weekNumber(this.rule.wkst);i.day=n.Time.daysInMonth(d,e);var m=i.weekNumber(this.rule.wkst);for(f=l;f<m;f++)v[f]=1}for(var y=0;y<this.by_data.BYWEEKNO.length&&c;y++){var p=this.by_data.BYWEEKNO[y];p<52?c&=v[y]:c=0}c?delete t.BYMONTH:delete t.BYWEEKNO}var _=Object.keys(t).length;if(_==0){var A=this.dtstart.clone();A.year=this.last.year,this.days.push(A.dayOfYear())}else if(_==1&&"BYMONTH"in t){for(var D in this.by_data.BYMONTH)if(!!this.by_data.BYMONTH.hasOwnProperty(D)){var b=this.dtstart.clone();b.year=e,b.month=this.by_data.BYMONTH[D],b.isDate=!0,this.days.push(b.dayOfYear())}}else if(_==1&&"BYMONTHDAY"in t){for(var g in this.by_data.BYMONTHDAY)if(!!this.by_data.BYMONTHDAY.hasOwnProperty(g)){var O=this.dtstart.clone(),E=this.by_data.BYMONTHDAY[g];if(E<0){var C=n.Time.daysInMonth(O.month,e);E=E+C+1}O.day=E,O.year=e,O.isDate=!0,this.days.push(O.dayOfYear())}}else if(_==2&&"BYMONTHDAY"in t&&"BYMONTH"in t){for(var D in this.by_data.BYMONTH)if(!!this.by_data.BYMONTH.hasOwnProperty(D)){var N=this.by_data.BYMONTH[D],C=n.Time.daysInMonth(N,e);for(var g in this.by_data.BYMONTHDAY)if(!!this.by_data.BYMONTHDAY.hasOwnProperty(g)){var E=this.by_data.BYMONTHDAY[g];E<0&&(E=E+C+1),i.day=E,i.month=N,i.year=e,i.isDate=!0,this.days.push(i.dayOfYear())}}}else if(!(_==1&&"BYWEEKNO"in t)){if(!(_==2&&"BYWEEKNO"in t&&"BYMONTHDAY"in t))if(_==1&&"BYDAY"in t)this.days=this.days.concat(this.expand_by_day(e));else if(_==2&&"BYDAY"in t&&"BYMONTH"in t){for(var D in this.by_data.BYMONTH)if(!!this.by_data.BYMONTH.hasOwnProperty(D)){var d=this.by_data.BYMONTH[D],C=n.Time.daysInMonth(d,e);i.year=e,i.month=this.by_data.BYMONTH[D],i.day=1,i.isDate=!0;var z=i.dayOfWeek(),x=i.dayOfYear()-1;i.day=C;var B=i.dayOfWeek();if(this.has_by_data("BYSETPOS")){for(var I=0,M=[],S=1;S<=C;S++)i.day=S,this.is_day_in_byday(i)&&M.push(S);for(var P=0;P<M.length;P++)(this.check_set_position(P+1)||this.check_set_position(P-M.length))&&this.days.push(x+M[P])}else for(var h in this.by_data.BYDAY)if(!!this.by_data.BYDAY.hasOwnProperty(h)){var T=this.by_data.BYDAY[h],w=this.ruleDayOfWeek(T),Y=w[0],R=w[1],L,k=(R+7-z)%7+1,Z=C-(B+7-R)%7;if(Y==0)for(var S=k;S<=C;S+=7)this.days.push(x+S);else Y>0?(L=k+(Y-1)*7,L<=C&&this.days.push(x+L)):(L=Z+(Y+1)*7,L>0&&this.days.push(x+L))}}this.days.sort(function(X,G){return X-G})}else if(_==2&&"BYDAY"in t&&"BYMONTHDAY"in t){var U=this.expand_by_day(e);for(var H in U)if(!!U.hasOwnProperty(H)){var S=U[H],W=n.Time.fromDayOfYear(S,e);this.by_data.BYMONTHDAY.indexOf(W.day)>=0&&this.days.push(S)}}else if(_==3&&"BYDAY"in t&&"BYMONTHDAY"in t&&"BYMONTH"in t){var U=this.expand_by_day(e);for(var H in U)if(!!U.hasOwnProperty(H)){var S=U[H],W=n.Time.fromDayOfYear(S,e);this.by_data.BYMONTH.indexOf(W.month)>=0&&this.by_data.BYMONTHDAY.indexOf(W.day)>=0&&this.days.push(S)}}else if(_==2&&"BYDAY"in t&&"BYWEEKNO"in t){var U=this.expand_by_day(e);for(var H in U)if(!!U.hasOwnProperty(H)){var S=U[H],W=n.Time.fromDayOfYear(S,e),p=W.weekNumber(this.rule.wkst);this.by_data.BYWEEKNO.indexOf(p)&&this.days.push(S)}}else _==3&&"BYDAY"in t&&"BYWEEKNO"in t&&"BYMONTHDAY"in t||(_==1&&"BYYEARDAY"in t?this.days=this.days.concat(this.by_data.BYYEARDAY):this.days=[])}return 0},expand_by_day:function(e){var i=[],t=this.last.clone();t.year=e,t.month=1,t.day=1,t.isDate=!0;var s=t.dayOfWeek();t.month=12,t.day=31,t.isDate=!0;var a=t.dayOfWeek(),u=t.dayOfYear();for(var c in this.by_data.BYDAY)if(!!this.by_data.BYDAY.hasOwnProperty(c)){var v=this.by_data.BYDAY[c],f=this.ruleDayOfWeek(v),d=f[0],l=f[1];if(d==0)for(var m=(l+7-s)%7+1,y=m;y<=u;y+=7)i.push(y);else if(d>0){var p;l>=s?p=l-s+1:p=l-s+8,i.push(p+(d-1)*7)}else{var _;d=-d,l<=a?_=u-a+l:_=u-a+l-7,i.push(_-(d-1)*7)}}return i},is_day_in_byday:function(e){for(var i in this.by_data.BYDAY)if(!!this.by_data.BYDAY.hasOwnProperty(i)){var t=this.by_data.BYDAY[i],s=this.ruleDayOfWeek(t),a=s[0],u=s[1],c=e.dayOfWeek();if(a==0&&u==c||e.nthWeekDay(u,a)==e.day)return 1}return 0},check_set_position:function(e){if(this.has_by_data("BYSETPOS")){var i=this.by_data.BYSETPOS.indexOf(e);return i!==-1}return!1},sort_byday_rules:function(e){for(var i=0;i<e.length;i++)for(var t=0;t<i;t++){var s=this.ruleDayOfWeek(e[t],this.rule.wkst)[1],a=this.ruleDayOfWeek(e[i],this.rule.wkst)[1];if(s>a){var u=e[i];e[i]=e[t],e[t]=u}}},check_contract_restriction:function(e,i){var t=o._indexMap[e],s=o._expandMap[this.rule.freq][t],a=!1;if(e in this.by_data&&s==o.CONTRACT){var u=this.by_data[e];for(var c in u)if(u.hasOwnProperty(c)&&u[c]==i){a=!0;break}}else a=!0;return a},check_contracting_rules:function(){var e=this.last.dayOfWeek(),i=this.last.weekNumber(this.rule.wkst),t=this.last.dayOfYear();return this.check_contract_restriction("BYSECOND",this.last.second)&&this.check_contract_restriction("BYMINUTE",this.last.minute)&&this.check_contract_restriction("BYHOUR",this.last.hour)&&this.check_contract_restriction("BYDAY",n.Recur.numericDayToIcalDay(e))&&this.check_contract_restriction("BYWEEKNO",i)&&this.check_contract_restriction("BYMONTHDAY",this.last.day)&&this.check_contract_restriction("BYMONTH",this.last.month)&&this.check_contract_restriction("BYYEARDAY",t)},setup_defaults:function(e,i,t){var s=o._indexMap[e],a=o._expandMap[this.rule.freq][s];return a!=o.CONTRACT&&(e in this.by_data||(this.by_data[e]=[t]),this.rule.freq!=i)?this.by_data[e][0]:t},toJSON:function(){var r=Object.create(null);return r.initialized=this.initialized,r.rule=this.rule.toJSON(),r.dtstart=this.dtstart.toJSON(),r.by_data=this.by_data,r.days=this.days,r.last=this.last.toJSON(),r.by_indices=this.by_indices,r.occurrence_number=this.occurrence_number,r}},o._indexMap={BYSECOND:0,BYMINUTE:1,BYHOUR:2,BYDAY:3,BYMONTHDAY:4,BYYEARDAY:5,BYWEEKNO:6,BYMONTH:7,BYSETPOS:8},o._expandMap={SECONDLY:[1,1,1,1,1,1,1,1],MINUTELY:[2,1,1,1,1,1,1,1],HOURLY:[2,2,1,1,1,1,1,1],DAILY:[2,2,2,1,1,1,1,1],WEEKLY:[2,2,2,2,3,3,1,1],MONTHLY:[2,2,2,2,2,3,3,1],YEARLY:[2,2,2,2,2,2,2,2]},o.UNKNOWN=0,o.CONTRACT=1,o.EXPAND=2,o.ILLEGAL=3,o}();n.RecurExpansion=function(){function o(t){return n.helpers.formatClassType(t,n.Time)}function r(t,s){return t.compare(s)}function e(t){return t.hasProperty("rdate")||t.hasProperty("rrule")||t.hasProperty("recurrence-id")}function i(t){this.ruleDates=[],this.exDates=[],this.fromData(t)}return i.prototype={complete:!1,ruleIterators:null,ruleDates:null,exDates:null,ruleDateInc:0,exDateInc:0,exDate:null,ruleDate:null,dtstart:null,last:null,fromData:function(t){var s=n.helpers.formatClassType(t.dtstart,n.Time);if(s)this.dtstart=s;else throw new Error(".dtstart (ICAL.Time) must be given");if(t.component)this._init(t.component);else{if(this.last=o(t.last)||s.clone(),!t.ruleIterators)throw new Error(".ruleIterators or .component must be given");this.ruleIterators=t.ruleIterators.map(function(a){return n.helpers.formatClassType(a,n.RecurIterator)}),this.ruleDateInc=t.ruleDateInc,this.exDateInc=t.exDateInc,t.ruleDates&&(this.ruleDates=t.ruleDates.map(o),this.ruleDate=this.ruleDates[this.ruleDateInc]),t.exDates&&(this.exDates=t.exDates.map(o),this.exDate=this.exDates[this.exDateInc]),typeof t.complete<"u"&&(this.complete=t.complete)}},next:function(){for(var t,s,a,u,c=500,v=0;;){if(v++>c)throw new Error("max tries have occured, rule may be impossible to forfill.");if(a=this.ruleDate,t=this._nextRecurrenceIter(this.last),!a&&!t){this.complete=!0;break}if((!a||t&&a.compare(t.last)>0)&&(a=t.last.clone(),t.next()),this.ruleDate===a&&this._nextRuleDay(),this.last=a,this.exDate&&(u=this.exDate.compare(this.last),u<0&&this._nextExDay(),u===0)){this._nextExDay();continue}return this.last}},toJSON:function(){function t(a){return a.toJSON()}var s=Object.create(null);return s.ruleIterators=this.ruleIterators.map(t),this.ruleDates&&(s.ruleDates=this.ruleDates.map(t)),this.exDates&&(s.exDates=this.exDates.map(t)),s.ruleDateInc=this.ruleDateInc,s.exDateInc=this.exDateInc,s.last=this.last.toJSON(),s.dtstart=this.dtstart.toJSON(),s.complete=this.complete,s},_extractDates:function(t,s){function a(m){l=n.helpers.binsearchInsert(u,m,r),u.splice(l,0,m)}for(var u=[],c=t.getAllProperties(s),v=c.length,f=0,d,l;f<v;f++)c[f].getValues().forEach(a);return u},_init:function(t){if(this.ruleIterators=[],this.last=this.dtstart.clone(),!e(t)){this.ruleDate=this.last.clone(),this.complete=!0;return}if(t.hasProperty("rdate")&&(this.ruleDates=this._extractDates(t,"rdate"),this.ruleDates[0]&&this.ruleDates[0].compare(this.dtstart)<0?(this.ruleDateInc=0,this.last=this.ruleDates[0].clone()):this.ruleDateInc=n.helpers.binsearchInsert(this.ruleDates,this.last,r),this.ruleDate=this.ruleDates[this.ruleDateInc]),t.hasProperty("rrule"))for(var s=t.getAllProperties("rrule"),a=0,u=s.length,c,v;a<u;a++)c=s[a].getFirstValue(),v=c.iterator(this.dtstart),this.ruleIterators.push(v),v.next();t.hasProperty("exdate")&&(this.exDates=this._extractDates(t,"exdate"),this.exDateInc=n.helpers.binsearchInsert(this.exDates,this.last,r),this.exDate=this.exDates[this.exDateInc])},_nextExDay:function(){this.exDate=this.exDates[++this.exDateInc]},_nextRuleDay:function(){this.ruleDate=this.ruleDates[++this.ruleDateInc]},_nextRecurrenceIter:function(){var t=this.ruleIterators;if(t.length===0)return null;for(var s=t.length,a,u,c=0,v;c<s;c++){if(a=t[c],u=a.last,a.completed){s--,c!==0&&c--,t.splice(c,1);continue}(!v||v.last.compare(u)>0)&&(v=a)}return v}},i}();n.Event=function(){function o(e,i){e instanceof n.Component||(i=e,e=null),e?this.component=e:this.component=new n.Component("vevent"),this._rangeExceptionCache=Object.create(null),this.exceptions=Object.create(null),this.rangeExceptions=[],i&&i.strictExceptions&&(this.strictExceptions=i.strictExceptions),i&&i.exceptions?i.exceptions.forEach(this.relateException,this):this.component.parent&&!this.isRecurrenceException()&&this.component.parent.getAllSubcomponents("vevent").forEach(function(t){t.hasProperty("recurrence-id")&&this.relateException(t)},this)}o.prototype={THISANDFUTURE:"THISANDFUTURE",exceptions:null,strictExceptions:!1,relateException:function(e){if(this.isRecurrenceException())throw new Error("cannot relate exception to exceptions");if(e instanceof n.Component&&(e=new n.Event(e)),this.strictExceptions&&e.uid!==this.uid)throw new Error("attempted to relate unrelated exception");var i=e.recurrenceId.toString();if(this.exceptions[i]=e,e.modifiesFuture()){var t=[e.recurrenceId.toUnixTime(),i],s=n.helpers.binsearchInsert(this.rangeExceptions,t,r);this.rangeExceptions.splice(s,0,t)}},modifiesFuture:function(){if(!this.component.hasProperty("recurrence-id"))return!1;var e=this.component.getFirstProperty("recurrence-id").getParameter("range");return e===this.THISANDFUTURE},findRangeException:function(e){if(!this.rangeExceptions.length)return null;var i=e.toUnixTime(),t=n.helpers.binsearchInsert(this.rangeExceptions,[i],r);if(t-=1,t<0)return null;var s=this.rangeExceptions[t];return i<s[0]?null:s[1]},getOccurrenceDetails:function(e){var i=e.toString(),t=e.convertToZone(n.Timezone.utcTimezone).toString(),s,a={recurrenceId:e};if(i in this.exceptions)s=a.item=this.exceptions[i],a.startDate=s.startDate,a.endDate=s.endDate,a.item=s;else if(t in this.exceptions)s=this.exceptions[t],a.startDate=s.startDate,a.endDate=s.endDate,a.item=s;else{var u=this.findRangeException(e),c;if(u){var v=this.exceptions[u];a.item=v;var f=this._rangeExceptionCache[u];if(!f){var d=v.recurrenceId.clone(),l=v.startDate.clone();d.zone=l.zone,f=l.subtractDate(d),this._rangeExceptionCache[u]=f}var m=e.clone();m.zone=v.startDate.zone,m.addDuration(f),c=m.clone(),c.addDuration(v.duration),a.startDate=m,a.endDate=c}else c=e.clone(),c.addDuration(this.duration),a.endDate=c,a.startDate=e,a.item=this}return a},iterator:function(e){return new n.RecurExpansion({component:this.component,dtstart:e||this.startDate})},isRecurring:function(){var e=this.component;return e.hasProperty("rrule")||e.hasProperty("rdate")},isRecurrenceException:function(){return this.component.hasProperty("recurrence-id")},getRecurrenceTypes:function(){for(var e=this.component.getAllProperties("rrule"),i=0,t=e.length,s=Object.create(null);i<t;i++){var a=e[i].getFirstValue();s[a.freq]=!0}return s},get uid(){return this._firstProp("uid")},set uid(e){this._setProp("uid",e)},get startDate(){return this._firstProp("dtstart")},set startDate(e){this._setTime("dtstart",e)},get endDate(){var e=this._firstProp("dtend");if(!e){var i=this._firstProp("duration");e=this.startDate.clone(),i?e.addDuration(i):e.isDate&&(e.day+=1)}return e},set endDate(e){this.component.hasProperty("duration")&&this.component.removeProperty("duration"),this._setTime("dtend",e)},get duration(){var e=this._firstProp("duration");return e||this.endDate.subtractDateTz(this.startDate)},set duration(e){this.component.hasProperty("dtend")&&this.component.removeProperty("dtend"),this._setProp("duration",e)},get location(){return this._firstProp("location")},set location(e){return this._setProp("location",e)},get attendees(){return this.component.getAllProperties("attendee")},get summary(){return this._firstProp("summary")},set summary(e){this._setProp("summary",e)},get description(){return this._firstProp("description")},set description(e){this._setProp("description",e)},get color(){return this._firstProp("color")},set color(e){this._setProp("color",e)},get organizer(){return this._firstProp("organizer")},set organizer(e){this._setProp("organizer",e)},get sequence(){return this._firstProp("sequence")},set sequence(e){this._setProp("sequence",e)},get recurrenceId(){return this._firstProp("recurrence-id")},set recurrenceId(e){this._setTime("recurrence-id",e)},_setTime:function(e,i){var t=this.component.getFirstProperty(e);t||(t=new n.Property(e),this.component.addProperty(t)),i.zone===n.Timezone.localTimezone||i.zone===n.Timezone.utcTimezone?t.removeParameter("tzid"):t.setParameter("tzid",i.zone.tzid),t.setValue(i)},_setProp:function(e,i){this.component.updatePropertyWithValue(e,i)},_firstProp:function(e){return this.component.getFirstPropertyValue(e)},toString:function(){return this.component.toString()}};function r(e,i){return e[0]>i[0]?1:i[0]>e[0]?-1:0}return o}();n.ComponentParser=function(){function o(r){typeof r>"u"&&(r={});var e;for(e in r)r.hasOwnProperty(e)&&(this[e]=r[e])}return o.prototype={parseEvent:!0,parseTimezone:!0,oncomplete:function(){},onerror:function(r){},ontimezone:function(r){},onevent:function(r){},process:function(r){typeof r=="string"&&(r=n.parse(r)),r instanceof n.Component||(r=new n.Component(r));for(var e=r.getAllSubcomponents(),i=0,t=e.length,s;i<t;i++)switch(s=e[i],s.name){case"vtimezone":if(this.parseTimezone){var a=s.getFirstPropertyValue("tzid");a&&this.ontimezone(new n.Timezone({tzid:a,component:s}))}break;case"vevent":this.parseEvent&&this.onevent(new n.Event(s));break;default:continue}this.oncomplete()}},o}()});var j=se(K(),1),q="https://google.com/";function ae(o,r){let{classTimes:e,breakTimes:i,breaksToNextHour:t}=r,s=j.default.parse(o),u=new j.default.Component(s).getAllSubcomponents("vevent"),c=[[],[],[],[],[],[],[]],v=0;for(let f of u){let d=new j.default.Event(f),[l,m,y]=d.summary.split(" - "),p=new Date;p.setTime(Date.parse(d.startDate.toJSDate()));let _=p.getHours()*3600+p.getMinutes()*60,A=new Date;A.setTime(Date.parse(d.endDate.toJSDate()));let D=A.getHours()*3600+A.getMinutes()*60;if(console.log(`Day ${p.getDay()} at ${_}`),console.log(`Day ${A.getDay()} at ${D}`),p.getDay()<v)break;v=p.getDay();let b=c[p.getDay()];for(let g=0;g<e.length;g++){let O=e[g];console.log(`hour: ${g+1} start: ${O[0]}, end: ${O[1]}`),_<=O[0]&&O[1]<D&&b.push({vak:m,lokaal:l,hour:g+1})}}return{classTimes:e,breakTimes:i,breaksToNextHour:t,SchoolSchedule:c}}async function oe(o){let r;if(Keychain.contains("nextHourWidgetSourceURL")){let e=new Alert;switch(e.message="Wil je de reeds doorgegeven URL gebruiken?",e.addAction("ja"),e.addAction("nee"),e.addCancelAction("exit"),await e.present()){case-1:return null;case 0:r=Keychain.get("nextHourWidgetSourceURL")}}if(!r){let e=new Alert;if(e.message="Kopieer de URL",e.addTextField("URL"),e.addAction("submit"),e.addCancelAction("exit"),await e.present()==-1)return null;r=e.textFieldValue(0)}console.log("sending request");try{let i=await new Request(r).loadString();try{let t=ae(i,o);return Keychain.set("nextHourWidgetData",JSON.stringify(t)),!1}catch{return`De data die opgehaald is voldoet niet. Probeer het opnieuw en check de URL of neem anders contact met ons op. (${q})`}}catch(e){return console.log(e),"Er kan geen verbinding gemaakt worden met de server van Somtoday. Check je internet verbinding/Check of de URL goed gekopieerd is."}}async function ue(){let o=new Alert;if(o.message="Heb je de online handleiding al gevolgd?",o.addAction("ja"),o.addAction("nee"),await o.presentAlert()==0){let e=new Alert;e.message="Slecteer het bestand op de volgende pagina",e.addAction("OK"),await e.presentAlert();let i=(await DocumentPicker.open(["public.json"]))[0],t=await J(i);return Keychain.set("nextHourWidgetData",JSON.stringify(t)),!1}else{let e=new Alert;if(e.message="klik op ok om door te gaan naar url.com en volg de instructies",e.addAction("ok"),e.addCancelAction("exit"),await e.present()==-1)return null;try{Safari.open(q)}catch(t){console.log(t)}return null}}async function J(o=""){let r=FileManager.iCloud(),e="";if(o)e=o;else{if(Keychain.contains("nextHourWidgetData"))return JSON.parse(Keychain.get("nextHourWidgetData"));throw Error("Setup not finished")}try{await r.downloadFileFromiCloud(e);let i=Data.fromFile(e);return JSON.parse(i.toRawString())}catch(i){throw console.log(i),Error(i)}}(async()=>{let o;try{o=await J()}catch(t){console.log(t)}let r=new Alert;r.message="Hoe wil je bijwerken?",o&&r.addAction("auto update"),r.addAction("manual update"),r.addCancelAction("exit");let e=await r.present(),i;if(e!=-1){if(e==0&&o)i=await oe(o);else try{i=await ue()}catch(t){console.error(t),i="Er is iets fout gegaan, probeer het op nieuw("+t+")"}if(i){let t=new Alert;t.message=i,t.addCancelAction("exit"),await t.present()}else{if(i==null)return;{let t=new Alert;t.message="Enter offset time: ",t.addTextField("in seconds").setNumberPadKeyboard(),t.addAction("submit"),await t.present();let a=t.textFieldValue(0);console.log(a),Keychain.set("nextHourWidgetOffset",a&&"0");let u=new Alert;u.message="You are done!",u.addCancelAction("ok"),await u.presentAlert()}}}})();})();
